import os
import numpy as np
from PyQt5.QtWidgets import QFileDialog, QMessageBox, QSlider
from PyQt5.QtCore import Qt, QSettings
from matplotlib.backends.backend_qt5agg import FigureCanvasQTAgg as FigureCanvas
from matplotlib.figure import Figure
from scipy.signal import find_peaks, savgol_filter
from PyQt5.QtWidgets import QSpacerItem, QVBoxLayout
from matplotlib.patches import Rectangle
import matplotlib.pyplot as plt
from scipy.signal import savgol_filter, find_peaks




data_c_npsc1 = np.array([[0.00000000e+00, 7.00971000e+19, 1.04712900e-03],
       [4.71000000e-02, 7.21107000e+19, 1.02070400e-03],
       [9.43000000e-02, 7.26942000e+19, 1.01321100e-03],
       [1.41400000e-01, 7.05180000e+19, 1.04135800e-03],
       [1.88500000e-01, 6.98072000e+19, 1.05123500e-03],
       [2.35700000e-01, 7.00487000e+19, 1.04785200e-03],
       [2.82800000e-01, 6.93107000e+19, 1.05803500e-03],
       [3.30000000e-01, 6.52079000e+19, 1.11815000e-03],
       [3.77100000e-01, 5.81300000e+19, 1.24193800e-03],
       [4.24200000e-01, 5.04429000e+19, 1.41579400e-03],
       [4.71400000e-01, 4.31420000e+19, 1.63681700e-03],
       [5.18500000e-01, 3.23594000e+19, 2.13943900e-03],
       [5.65600000e-01, 2.10378000e+19, 3.16737900e-03],
       [6.12800000e-01, 1.61362000e+19, 3.98749400e-03],
       [6.59900000e-01, 1.34741000e+19, 4.63020300e-03],
       [7.07000000e-01, 1.15691000e+19, 5.22757200e-03],
       [7.54200000e-01, 1.01321000e+19, 5.78628700e-03],
       [8.01300000e-01, 8.88996000e+18, 6.37529100e-03],
       [8.48400000e-01, 7.71792000e+18, 7.05342400e-03],
       [8.95600000e-01, 6.60693000e+18, 7.84693400e-03],
       [9.42700000e-01, 5.55904000e+18, 8.79427400e-03],
       [9.89900000e-01, 4.57299000e+18, 9.94718100e-03],
       [1.03700000e+00, 3.66522000e+18, 1.13658000e-02],
       [1.08410000e+00, 2.86286000e+18, 1.31099190e-02],
       [1.13130000e+00, 2.18424000e+18, 1.52335110e-02],
       [1.17840000e+00, 1.74502000e+18, 1.71988730e-02],
       [1.22550000e+00, 1.50938000e+18, 1.85780450e-02],
       [1.27270000e+00, 1.37626000e+18, 1.95074270e-02],
       [1.31980000e+00, 1.29033000e+18, 2.01790170e-02],
       [1.36690000e+00, 1.24968000e+18, 2.05210700e-02],
       [1.41410000e+00, 1.22574000e+18, 2.07252610e-02],
       [1.46120000e+00, 1.18331000e+18, 2.11154330e-02],
       [1.50840000e+00, 1.12254000e+18, 2.17020120e-02],
       [1.55550000e+00, 1.06660000e+18, 2.22894830e-02],
       [1.60260000e+00, 1.01181000e+18, 2.29139520e-02],
       [1.64980000e+00, 9.55873000e+17, 2.36047820e-02],
       [1.69690000e+00, 9.01779000e+17, 2.43276410e-02],
       [1.74400000e+00, 8.50550000e+17, 2.50841850e-02],
       [1.79120000e+00, 8.01678000e+17, 2.58702130e-02],
       [1.83830000e+00, 7.52142000e+17, 2.67485350e-02],
       [1.88540000e+00, 6.98715000e+17, 2.77971330e-02],
       [1.93260000e+00, 6.41357000e+17, 2.90736800e-02],
       [1.97970000e+00, 5.83176000e+17, 3.05703210e-02],
       [2.02690000e+00, 5.26866000e+17, 3.22552190e-02],
       [2.07400000e+00, 4.76650000e+17, 3.40251460e-02],
       [2.12110000e+00, 4.30626000e+17, 3.59252670e-02],
       [2.16830000e+00, 3.86990000e+17, 3.80627360e-02],
       [2.21540000e+00, 3.45621000e+17, 4.04948690e-02],
       [2.26250000e+00, 3.08248000e+17, 4.31419730e-02],
       [2.30970000e+00, 2.75233000e+17, 4.59621140e-02],
       [2.35680000e+00, 2.46831000e+17, 4.88990030e-02],
       [2.40390000e+00, 2.22229000e+17, 5.19517280e-02],
       [2.45110000e+00, 2.00632000e+17, 5.51442200e-02],
       [2.49820000e+00, 1.82390000e+17, 5.83445100e-02],
       [2.54530000e+00, 1.68229000e+17, 6.12491410e-02],
       [2.59250000e+00, 1.55561000e+17, 6.42243920e-02],
       [2.63960000e+00, 1.42692000e+17, 6.77329510e-02],
       [2.68680000e+00, 1.31129000e+17, 7.14002940e-02],
       [2.73390000e+00, 1.22744000e+17, 7.44217710e-02],
       [2.78100000e+00, 1.15425000e+17, 7.74105230e-02],
       [2.82820000e+00, 1.06611000e+17, 8.14704280e-02],
       [2.87530000e+00, 9.68947000e+16, 8.67361220e-02],
       [2.92240000e+00, 8.65765000e+16, 9.34759740e-02],
       [2.96960000e+00, 7.38244000e+16, 1.04207745e-01],
       [3.01670000e+00, 6.03532000e+16, 1.20060459e-01],
       [3.06380000e+00, 4.64836000e+16, 1.45244602e-01],
       [3.11100000e+00, 3.08106000e+16, 1.99296651e-01],
       [3.15810000e+00, 1.98838000e+16, 2.84839359e-01],
       [3.20530000e+00, 1.38420000e+16, 3.88150366e-01],
       [3.25240000e+00, 1.09270000e+16, 4.77859253e-01],
       [3.29950000e+00, 9.89008000e+15, 5.22275917e-01],
       [3.34670000e+00, 9.34329000e+15, 5.49540874e-01],
       [3.39380000e+00, 9.02610000e+15, 5.67022118e-01],
       [3.44090000e+00, 8.88792000e+15, 5.74910182e-01],
       [3.48810000e+00, 8.92278000e+15, 5.72796031e-01],
       [3.53520000e+00, 9.04690000e+15, 5.65718003e-01],
       [3.58230000e+00, 9.13903000e+15, 5.60660552e-01],
       [3.62950000e+00, 9.09076000e+15, 5.63378151e-01],
       [3.67660000e+00, 8.95571000e+15, 5.70952528e-01],
       [3.72380000e+00, 8.78011000e+15, 5.81299568e-01],
       [3.77090000e+00, 8.40040000e+15, 6.05062169e-01],
       [3.81800000e+00, 7.84874000e+15, 6.43428065e-01],
       [3.86520000e+00, 7.20941000e+15, 6.95184371e-01],
       [3.91230000e+00, 6.39146000e+15, 7.76425875e-01],
       [3.95940000e+00, 5.34934000e+15, 9.15377008e-01],
       [4.00660000e+00, 4.24522000e+15, 1.13579512e+00],
       [4.05370000e+00, 3.03319000e+15, 1.56027087e+00],
       [4.10080000e+00, 2.17871000e+15, 2.13894688e+00],
       [4.14800000e+00, 1.75631000e+15, 2.63087370e+00],
       [4.19510000e+00, 1.49005000e+15, 3.08247810e+00],
       [4.24220000e+00, 1.32160000e+15, 3.46178427e+00],
       [4.28940000e+00, 1.20893000e+15, 3.77398352e+00],
       [4.33650000e+00, 1.12798000e+15, 4.03552461e+00],
       [4.38370000e+00, 1.07870000e+15, 4.21405306e+00],
       [4.43080000e+00, 1.05999000e+15, 4.28647209e+00],
       [4.47790000e+00, 1.05051000e+15, 4.32414253e+00],
       [4.52510000e+00, 1.04112000e+15, 4.36113971e+00],
       [4.57220000e+00, 1.02683000e+15, 4.41977336e+00],
       [4.61930000e+00, 1.01251000e+15, 4.48125853e+00],
       [4.66650000e+00, 9.98619000e+14, 4.54150713e+00],
       [4.71360000e+00, 9.85372000e+14, 4.60150608e+00],
       [4.76070000e+00, 9.71852000e+14, 4.66337135e+00],
       [4.80790000e+00, 9.58297000e+14, 4.72715671e+00],
       [4.85500000e+00, 9.42975000e+14, 4.80175503e+00],
       [4.90220000e+00, 9.18121000e+14, 4.92719783e+00],
       [4.94930000e+00, 8.88792000e+14, 5.08627690e+00],
       [4.99640000e+00, 8.59211000e+14, 5.25654032e+00],
       [5.04360000e+00, 8.24518000e+14, 5.47141933e+00],
       [5.09070000e+00, 7.86321000e+14, 5.73059874e+00],
       [5.13780000e+00, 7.45075000e+14, 6.03948629e+00],
       [5.18500000e+00, 6.93905000e+14, 6.47291643e+00],
       [5.23210000e+00, 6.37236000e+14, 7.03396171e+00],
       [5.27920000e+00, 5.80230000e+14, 7.70725982e+00],
       [5.32640000e+00, 5.22035000e+14, 8.54673031e+00],
       [5.37350000e+00, 4.60681000e+14, 9.65606098e+00],
       [5.42070000e+00, 3.99393000e+14, 1.11045253e+01],
       [5.46780000e+00, 3.40957000e+14, 1.29658203e+01],
       [5.51490000e+00, 2.85825000e+14, 1.54134550e+01],
       [5.56210000e+00, 2.33668000e+14, 1.87845156e+01],
       [5.60920000e+00, 1.88712000e+14, 2.31686111e+01],
       [5.65630000e+00, 1.53709000e+14, 2.83530641e+01],
       [5.70350000e+00, 1.26125000e+14, 3.44349931e+01],
       [5.75060000e+00, 1.04112000e+14, 4.15910611e+01],
       [5.79770000e+00, 8.70563000e+13, 4.96020927e+01],
       [5.84490000e+00, 7.39605000e+13, 5.82371348e+01],
       [5.89200000e+00, 6.47739000e+13, 6.63743070e+01],
       [5.93910000e+00, 5.92107000e+13, 7.25103498e+01],
       [5.98630000e+00, 5.58856000e+13, 7.67714954e+01],
       [6.03340000e+00, 5.38146000e+13, 7.96892978e+01],
       [6.08060000e+00, 5.27716000e+13, 8.12269227e+01],
       [6.12770000e+00, 5.26623000e+13, 8.13954259e+01],
       [6.17480000e+00, 5.31007000e+13, 8.07420924e+01],
       [6.22200000e+00, 5.39386000e+13, 7.95060175e+01],
       [6.26910000e+00, 5.55520000e+13, 7.72324835e+01],
       [6.31620000e+00, 5.82371000e+13, 7.37224908e+01],
       [6.36340000e+00, 6.14611000e+13, 6.99036737e+01],
       [6.41050000e+00, 6.52229000e+13, 6.59325693e+01],
       [6.45760000e+00, 6.96947000e+13, 6.17589637e+01],
       [6.50480000e+00, 7.47825000e+13, 5.76235486e+01],
       [6.55190000e+00, 8.03526000e+13, 5.36784541e+01],
       [6.59910000e+00, 8.66762000e+13, 4.98195729e+01],
       [6.64620000e+00, 9.40373000e+13, 4.59726989e+01],
       [6.69330000e+00, 1.02259000e+14, 4.23350425e+01],
       [6.74050000e+00, 1.11429000e+14, 3.89045145e+01],
       [6.78760000e+00, 1.21703000e+14, 3.56615323e+01],
       [6.83470000e+00, 1.33260000e+14, 3.26212050e+01],
       [6.88190000e+00, 1.46016000e+14, 2.98194755e+01],
       [6.92900000e+00, 1.59882000e+14, 2.72709332e+01],
       [6.97610000e+00, 1.74824000e+14, 2.49804352e+01],
       [7.02330000e+00, 1.90941000e+14, 2.29034022e+01],
       [7.07040000e+00, 2.08593000e+14, 2.09990670e+01],
       [7.11760000e+00, 2.27091000e+14, 1.93196832e+01],
       [7.16470000e+00, 2.45471000e+14, 1.78978144e+01],
       [7.21180000e+00, 2.63451000e+14, 1.66993666e+01],
       [7.25900000e+00, 2.80543000e+14, 1.57000126e+01],
       [7.30610000e+00, 2.95393000e+14, 1.49245072e+01],
       [7.35320000e+00, 3.07539000e+14, 1.43449818e+01],
       [7.40040000e+00, 3.17468000e+14, 1.39059287e+01],
       [7.44750000e+00, 3.26588000e+14, 1.35269536e+01],
       [7.49460000e+00, 3.34349000e+14, 1.32159991e+01],
       [7.54180000e+00, 3.39938000e+14, 1.30046899e+01],
       [7.58890000e+00, 3.43954000e+14, 1.28558264e+01],
       [7.63600000e+00, 3.47536000e+14, 1.27262368e+01],
       [7.68320000e+00, 3.50106000e+14, 1.26328110e+01],
       [7.73030000e+00, 3.51318000e+14, 1.25921532e+01],
       [7.77750000e+00, 3.51641000e+14, 1.25805608e+01],
       [7.82460000e+00, 3.51803000e+14, 1.25747685e+01],
       [7.87170000e+00, 3.51641000e+14, 1.25776643e+01],
       [7.91890000e+00, 3.51318000e+14, 1.25921532e+01],
       [7.96600000e+00, 3.50429000e+14, 1.26211811e+01],
       [8.01310000e+00, 3.49462000e+14, 1.26561030e+01],
       [8.06030000e+00, 3.48739000e+14, 1.26823578e+01],
       [8.10740000e+00, 3.48739000e+14, 1.26823578e+01],
       [8.15450000e+00, 3.49623000e+14, 1.26531891e+01],
       [8.20170000e+00, 3.51803000e+14, 1.25747685e+01],
       [8.24880000e+00, 3.54324000e+14, 1.24853293e+01]])



data_c_pcs1 = np.array([[0.00000000e+00, 1.35863000e+20, 8.67761000e-04],
       [1.06000000e-01, 1.29897000e+20, 9.06358000e-04],
       [2.12000000e-01, 1.27732000e+20, 9.21086000e-04],
       [3.18000000e-01, 1.28499000e+20, 9.15799000e-04],
       [4.24000000e-01, 1.27262000e+20, 9.24485000e-04],
       [5.29900000e-01, 1.18359000e+20, 9.91517000e-04],
       [6.35900000e-01, 9.84918000e+19, 1.18276900e-03],
       [7.41900000e-01, 7.98362000e+19, 1.44477400e-03],
       [8.47900000e-01, 6.73442000e+19, 1.69629000e-03],
       [9.53900000e-01, 5.68853000e+19, 1.98563800e-03],
       [1.05990000e+00, 4.82725000e+19, 2.31046800e-03],
       [1.16590000e+00, 4.16582000e+19, 2.64301700e-03],
       [1.27190000e+00, 3.83796000e+19, 2.84642700e-03],
       [1.37780000e+00, 3.47856000e+19, 3.10885200e-03],
       [1.48380000e+00, 2.92079000e+19, 3.62994500e-03],
       [1.58980000e+00, 2.37028000e+19, 4.35211100e-03],
       [1.69580000e+00, 1.92486000e+19, 5.19517300e-03],
       [1.80180000e+00, 1.45345000e+19, 6.55088500e-03],
       [1.90780000e+00, 1.03777000e+19, 8.56446000e-03],
       [2.01380000e+00, 6.77954000e+18, 1.18331400e-02],
       [2.11980000e+00, 4.01698000e+18, 1.72385210e-02],
       [2.22570000e+00, 2.65583000e+18, 2.28875870e-02],
       [2.33170000e+00, 2.10281000e+18, 2.67546950e-02],
       [2.43770000e+00, 1.76076000e+18, 3.00746100e-02],
       [2.54370000e+00, 1.56099000e+18, 3.25386850e-02],
       [2.64970000e+00, 1.39091000e+18, 3.50751870e-02],
       [2.75570000e+00, 1.15027000e+18, 3.96643190e-02],
       [2.86170000e+00, 9.31108000e+17, 4.54569190e-02],
       [2.96770000e+00, 7.50240000e+17, 5.22275920e-02],
       [3.07370000e+00, 5.83848000e+17, 6.13762010e-02],
       [3.17960000e+00, 4.25207000e+17, 7.53876140e-02],
       [3.28560000e+00, 2.89668000e+17, 9.70286520e-02],
       [3.39160000e+00, 1.88191000e+17, 1.29927176e-01],
       [3.49760000e+00, 1.40314000e+17, 1.59477713e-01],
       [3.60360000e+00, 1.21339000e+17, 1.76929398e-01],
       [3.70960000e+00, 1.12720000e+17, 1.86594999e-01],
       [3.81560000e+00, 1.06316000e+17, 1.94760105e-01],
       [3.92160000e+00, 1.02235000e+17, 2.00401053e-01],
       [4.02750000e+00, 1.01251000e+17, 2.01836636e-01],
       [4.13350000e+00, 1.04208000e+17, 1.97605942e-01],
       [4.23950000e+00, 1.07994000e+17, 1.92486378e-01],
       [4.34550000e+00, 1.09270000e+17, 1.90897394e-01],
       [4.45150000e+00, 1.07746000e+17, 1.92841278e-01],
       [4.55750000e+00, 9.57414000e+16, 2.10329408e-01],
       [4.66350000e+00, 7.92501000e+16, 2.42270201e-01],
       [4.76950000e+00, 6.09958000e+16, 2.96346635e-01],
       [4.87550000e+00, 3.70169000e+16, 4.43302316e-01],
       [4.98140000e+00, 2.29298000e+16, 6.67267542e-01],
       [5.08740000e+00, 1.69317000e+16, 8.73775775e-01],
       [5.19340000e+00, 1.39380000e+16, 1.04255746e+00],
       [5.29940000e+00, 1.27057000e+16, 1.13501082e+00],
       [5.40540000e+00, 1.23055000e+16, 1.16896094e+00],
       [5.51140000e+00, 1.21199000e+16, 1.18549575e+00],
       [5.61740000e+00, 1.20393000e+16, 1.19288891e+00],
       [5.72340000e+00, 1.19207000e+16, 1.20392657e+00],
       [5.82930000e+00, 1.17733000e+16, 1.21786738e+00],
       [5.93530000e+00, 1.17355000e+16, 1.22151836e+00],
       [6.04130000e+00, 1.18932000e+16, 1.20670191e+00],
       [6.14730000e+00, 1.22603000e+16, 1.17300537e+00],
       [6.25330000e+00, 1.21535000e+16, 1.18276918e+00],
       [6.35930000e+00, 1.18905000e+16, 1.20670191e+00],
       [6.46530000e+00, 1.24022000e+16, 1.16064659e+00],
       [6.57130000e+00, 1.36930000e+16, 1.05974164e+00],
       [6.67720000e+00, 1.16681000e+16, 1.22800462e+00],
       [6.78320000e+00, 7.08925000e+15, 1.96290825e+00],
       [6.88920000e+00, 3.62577000e+15, 3.75145724e+00],
       [6.99520000e+00, 1.55561000e+15, 8.62779863e+00],
       [7.10120000e+00, 1.06733000e+15, 1.25371840e+01],
       [7.20720000e+00, 9.54113000e+14, 1.40152226e+01],
       [7.31320000e+00, 9.41456000e+14, 1.42003811e+01],
       [7.41920000e+00, 9.32610000e+14, 1.43350760e+01],
       [7.52520000e+00, 9.24911000e+14, 1.44510698e+01],
       [7.63110000e+00, 9.21722000e+14, 1.45044077e+01],
       [7.73710000e+00, 9.26403000e+14, 1.44311187e+01],
       [7.84310000e+00, 9.39723000e+14, 1.42265633e+01],
       [7.94910000e+00, 9.56753000e+14, 1.39765506e+01],
       [8.05510000e+00, 9.72747000e+14, 1.37467489e+01],
       [8.16110000e+00, 9.82200000e+14, 1.36144468e+01],
       [8.26710000e+00, 9.81974000e+14, 1.36175820e+01],
       [8.37310000e+00, 9.76338000e+14, 1.36961972e+01],
       [8.47900000e+00, 9.69840000e+14, 1.37879595e+01],
       [8.58500000e+00, 9.67386000e+14, 1.38229265e+01],
       [8.69100000e+00, 9.69617000e+14, 1.37911347e+01],
       [8.79700000e+00, 9.73419000e+14, 1.37372563e+01],
       [8.90300000e+00, 9.77462000e+14, 1.36804379e+01],
       [9.00900000e+00, 9.80393000e+14, 1.36395487e+01],
       [9.11500000e+00, 9.81070000e+14, 1.36301301e+01],
       [9.22100000e+00, 9.79039000e+14, 1.36615508e+01],
       [9.32690000e+00, 9.74990000e+14, 1.37151323e+01],
       [9.43290000e+00, 9.70510000e+14, 1.37784384e+01],
       [9.53890000e+00, 9.53894000e+14, 1.40152226e+01],
       [9.64490000e+00, 9.18544000e+14, 1.45545908e+01],
       [9.75090000e+00, 8.71565000e+14, 1.53320420e+01],
       [9.85690000e+00, 8.20540000e+14, 1.62817094e+01],
       [9.96290000e+00, 7.47137000e+14, 1.78731047e+01],
       [1.00689000e+01, 6.53883000e+14, 2.04126787e+01],
       [1.01749000e+01, 5.67153000e+14, 2.35233949e+01],
       [1.02808000e+01, 5.00150000e+14, 2.66624467e+01],
       [1.03868000e+01, 4.70760000e+14, 2.83269620e+01],
       [1.04928000e+01, 4.60999000e+14, 2.89201140e+01],
       [1.05988000e+01, 4.58670000e+14, 2.90669859e+01],
       [1.07048000e+01, 4.65801000e+14, 2.86220015e+01],
       [1.08108000e+01, 5.23842000e+14, 2.54624389e+01],
       [1.09168000e+01, 6.74683000e+14, 1.97833575e+01],
       [1.10228000e+01, 9.86279000e+14, 1.35581364e+01],
       [1.11287000e+01, 1.56315000e+15, 8.58618022e+00],
       [1.12347000e+01, 3.20922000e+15, 4.22668614e+00],
       [1.13407000e+01, 6.78110000e+15, 2.04785876e+00],
       [1.14467000e+01, 1.67842000e+16, 8.80643228e-01],
       [1.15527000e+01, 5.28810000e+16, 3.31665272e-01],
       [1.16587000e+01, 2.41991000e+17, 1.09446027e-01],
       [1.17647000e+01, 8.67761000e+17, 4.75663690e-02],
       [1.18707000e+01, 1.69434000e+18, 3.08460810e-02],
       [1.19767000e+01, 2.64606000e+18, 2.29456310e-02],
       [1.20826000e+01, 3.46418000e+18, 1.90985330e-02],
       [1.21886000e+01, 4.15336000e+18, 1.68383680e-02],
       [1.22946000e+01, 4.30824000e+18, 1.64096760e-02],
       [1.24006000e+01, 4.35412000e+18, 1.62892090e-02],
       [1.25066000e+01, 4.39238000e+18, 1.61882540e-02],
       [1.26126000e+01, 4.41774000e+18, 1.61212980e-02],
       [1.27186000e+01, 4.43404000e+18, 1.60805170e-02],
       [1.28246000e+01, 4.45143000e+18, 1.60361460e-02],
       [1.29305000e+01, 4.46786000e+18, 1.59955800e-02],
       [1.30365000e+01, 4.48436000e+18, 1.59551170e-02],
       [1.31425000e+01, 4.49987000e+18, 1.59147570e-02],
       [1.32485000e+01, 4.51544000e+18, 1.58744980e-02],
       [1.33545000e+01, 4.53106000e+18, 1.58379880e-02],
       [1.34605000e+01, 4.53211000e+18, 1.58343410e-02],
       [1.35665000e+01, 4.51440000e+18, 1.58781540e-02],
       [1.36725000e+01, 4.50091000e+18, 1.59110920e-02],
       [1.37784000e+01, 4.51440000e+18, 1.58781540e-02],
       [1.38844000e+01, 4.57826000e+18, 1.57217180e-02],
       [1.39904000e+01, 4.65586000e+18, 1.55345970e-02],
       [1.40964000e+01, 4.69894000e+18, 1.54347640e-02],
       [1.42024000e+01, 4.70219000e+18, 1.54276580e-02],
       [1.43084000e+01, 4.70002000e+18, 1.54312110e-02],
       [1.44144000e+01, 4.70002000e+18, 1.54312110e-02],
       [1.45204000e+01, 4.70327000e+18, 1.54241060e-02],
       [1.46264000e+01, 4.70327000e+18, 1.54241060e-02],
       [1.47323000e+01, 4.70977000e+18, 1.54099060e-02],
       [1.48383000e+01, 4.74133000e+18, 1.53355730e-02],
       [1.49443000e+01, 4.79402000e+18, 1.52159820e-02],
       [1.50503000e+01, 4.85289000e+18, 1.50834260e-02]])

data_c_pcal = np.array([[0.00000000e+00, 2.30250000e+19, 4.46169600e-03],
       [5.07000000e-02, 2.30675000e+19, 4.45451100e-03],
       [1.01500000e-01, 2.43108000e+19, 4.25794500e-03],
       [1.52200000e-01, 2.58821000e+19, 4.03366700e-03],
       [2.02900000e-01, 2.66686000e+19, 3.93006700e-03],
       [2.53700000e-01, 2.70085000e+19, 3.88687000e-03],
       [3.04400000e-01, 2.77396000e+19, 3.79751900e-03],
       [3.55200000e-01, 2.90001000e+19, 3.65258200e-03],
       [4.05900000e-01, 2.99847000e+19, 3.54650000e-03],
       [4.56600000e-01, 3.00469000e+19, 3.54078900e-03],
       [5.07400000e-01, 2.90402000e+19, 3.64837900e-03],
       [5.58100000e-01, 2.80027000e+19, 3.76617100e-03],
       [6.08800000e-01, 2.84446000e+19, 3.71535200e-03],
       [6.59600000e-01, 2.88868000e+19, 3.66522000e-03],
       [7.10300000e-01, 2.72898000e+19, 3.85212200e-03],
       [7.61000000e-01, 2.60495000e+19, 4.01051400e-03],
       [8.11800000e-01, 2.70707000e+19, 3.87882300e-03],
       [8.62500000e-01, 2.74726000e+19, 3.83001100e-03],
       [9.13200000e-01, 2.76312000e+19, 3.81065800e-03],
       [9.64000000e-01, 1.56315000e+19, 6.17305300e-03],
       [1.01470000e+00, 6.15460000e+18, 1.27057410e-02],
       [1.06550000e+00, 3.27718000e+18, 1.98426650e-02],
       [1.11620000e+00, 2.16272000e+18, 2.62603190e-02],
       [1.16690000e+00, 1.83612000e+18, 2.92549930e-02],
       [1.21770000e+00, 1.78855000e+18, 2.97645970e-02],
       [1.26840000e+00, 1.74783000e+18, 3.02203850e-02],
       [1.31910000e+00, 1.71593000e+18, 3.05914460e-02],
       [1.36990000e+00, 1.69473000e+18, 3.08389800e-02],
       [1.42060000e+00, 1.68384000e+18, 3.09670620e-02],
       [1.47130000e+00, 1.67919000e+18, 3.10241580e-02],
       [1.52210000e+00, 1.67996000e+18, 3.10170150e-02],
       [1.57280000e+00, 1.68267000e+18, 3.09813260e-02],
       [1.62360000e+00, 1.68850000e+18, 3.09171890e-02],
       [1.67430000e+00, 1.69981000e+18, 3.07751370e-02],
       [1.72500000e+00, 1.70883000e+18, 3.06690270e-02],
       [1.77580000e+00, 1.71475000e+18, 3.06055370e-02],
       [1.82650000e+00, 1.71830000e+18, 3.05562460e-02],
       [1.87720000e+00, 1.71633000e+18, 3.05844020e-02],
       [1.92800000e+00, 1.70294000e+18, 3.07397270e-02],
       [1.97870000e+00, 1.67880000e+18, 3.10313020e-02],
       [2.02940000e+00, 1.64892000e+18, 3.13978560e-02],
       [2.08020000e+00, 1.62256000e+18, 3.17321870e-02],
       [2.13090000e+00, 1.60620000e+18, 3.19374330e-02],
       [2.18170000e+00, 1.60103000e+18, 3.20036860e-02],
       [2.23240000e+00, 1.60842000e+18, 3.19080310e-02],
       [2.28310000e+00, 1.62293000e+18, 3.17248810e-02],
       [2.33390000e+00, 1.60731000e+18, 3.19227280e-02],
       [2.38460000e+00, 1.57979000e+18, 3.22849410e-02],
       [2.43530000e+00, 1.57870000e+18, 3.22998120e-02],
       [2.48610000e+00, 1.60325000e+18, 3.19742230e-02],
       [2.53680000e+00, 1.64551000e+18, 3.14412640e-02],
       [2.58750000e+00, 1.76644000e+18, 3.00123500e-02],
       [2.63830000e+00, 1.88452000e+18, 2.87607360e-02],
       [2.68900000e+00, 1.88191000e+18, 2.87872380e-02],
       [2.73970000e+00, 1.68655000e+18, 3.09385530e-02],
       [2.79050000e+00, 1.04568000e+18, 4.21793610e-02],
       [2.84120000e+00, 5.80898000e+17, 6.15743730e-02],
       [2.89200000e+00, 3.04439000e+17, 9.38858190e-02],
       [2.94270000e+00, 1.88408000e+17, 1.29807564e-01],
       [2.99340000e+00, 1.68694000e+17, 1.40119958e-01],
       [3.04420000e+00, 1.63042000e+17, 1.43482852e-01],
       [3.09490000e+00, 1.59809000e+17, 1.45512399e-01],
       [3.14560000e+00, 1.58380000e+17, 1.46419864e-01],
       [3.19640000e+00, 1.58198000e+17, 1.46554784e-01],
       [3.24710000e+00, 1.58672000e+17, 1.46251389e-01],
       [3.29780000e+00, 1.59148000e+17, 1.45915020e-01],
       [3.34860000e+00, 1.59588000e+17, 1.45646482e-01],
       [3.39930000e+00, 1.59993000e+17, 1.45378439e-01],
       [3.45010000e+00, 1.60435000e+17, 1.45110888e-01],
       [3.50080000e+00, 1.60509000e+17, 1.45077479e-01],
       [3.55150000e+00, 1.60029000e+17, 1.45378439e-01],
       [3.60230000e+00, 1.59478000e+17, 1.45713570e-01],
       [3.65300000e+00, 1.59551000e+17, 1.45680023e-01],
       [3.70370000e+00, 1.60177000e+17, 1.45278049e-01],
       [3.75450000e+00, 1.61027000e+17, 1.44743810e-01],
       [3.80520000e+00, 1.62592000e+17, 1.43780503e-01],
       [3.85590000e+00, 1.63908000e+17, 1.42988134e-01],
       [3.90670000e+00, 1.64172000e+17, 1.42823608e-01],
       [3.95740000e+00, 1.64437000e+17, 1.42659271e-01],
       [4.00810000e+00, 1.63983000e+17, 1.42922301e-01],
       [4.05890000e+00, 1.63042000e+17, 1.43482852e-01],
       [4.10960000e+00, 1.61771000e+17, 1.44277962e-01],
       [4.16040000e+00, 1.59221000e+17, 1.45881426e-01],
       [4.21110000e+00, 1.56603000e+17, 1.47604637e-01],
       [4.26180000e+00, 1.55668000e+17, 1.48217676e-01],
       [4.31260000e+00, 1.55096000e+17, 1.48593564e-01],
       [4.36330000e+00, 1.54739000e+17, 1.48833262e-01],
       [4.41400000e+00, 1.50591000e+17, 1.51705037e-01],
       [4.46480000e+00, 1.42955000e+17, 1.57398286e-01],
       [4.51550000e+00, 1.42626000e+17, 1.57652187e-01],
       [4.56620000e+00, 1.60140000e+17, 1.45311505e-01],
       [4.61700000e+00, 1.66418000e+17, 1.41481612e-01],
       [4.66770000e+00, 1.44911000e+17, 1.55883447e-01],
       [4.71850000e+00, 1.20754000e+17, 1.77541547e-01],
       [4.76920000e+00, 9.44496000e+16, 2.12422248e-01],
       [4.81990000e+00, 6.24741000e+16, 2.90870716e-01],
       [4.87070000e+00, 3.25387000e+16, 4.93855620e-01],
       [4.92140000e+00, 2.00956000e+16, 7.49548950e-01],
       [4.97210000e+00, 1.57652000e+16, 9.31751284e-01],
       [5.02290000e+00, 1.48252000e+16, 9.85371507e-01],
       [5.07360000e+00, 1.53922000e+16, 9.52357486e-01],
       [5.12430000e+00, 1.63606000e+16, 9.01156044e-01],
       [5.17510000e+00, 1.62592000e+16, 9.06149802e-01],
       [5.22580000e+00, 1.59845000e+16, 9.20237655e-01],
       [5.27660000e+00, 1.57398000e+16, 9.33254301e-01],
       [5.32730000e+00, 1.54632000e+16, 9.48418463e-01],
       [5.37800000e+00, 1.52335000e+16, 9.61390884e-01],
       [5.42880000e+00, 1.50904000e+16, 9.69616506e-01],
       [5.47950000e+00, 1.50730000e+16, 9.70509967e-01],
       [5.53020000e+00, 1.50765000e+16, 9.70509967e-01],
       [5.58100000e+00, 1.51252000e+16, 9.67609225e-01],
       [5.63170000e+00, 1.53356000e+16, 9.55432478e-01],
       [5.68240000e+00, 1.55274000e+16, 9.44713236e-01],
       [5.73320000e+00, 1.54989000e+16, 9.46237161e-01],
       [5.78390000e+00, 1.53780000e+16, 9.53235044e-01],
       [5.83460000e+00, 1.51950000e+16, 9.63607119e-01],
       [5.88540000e+00, 1.49589000e+16, 9.77462264e-01],
       [5.93610000e+00, 1.47979000e+16, 9.86961019e-01],
       [5.98690000e+00, 1.45881000e+16, 1.00000000e+00],
       [6.03760000e+00, 1.44777000e+16, 1.00693167e+00],
       [6.08830000e+00, 1.47299000e+16, 9.91288345e-01],
       [6.13910000e+00, 1.47809000e+16, 9.88097954e-01],
       [6.18980000e+00, 1.47197000e+16, 9.91744955e-01],
       [6.24050000e+00, 1.48491000e+16, 9.84011106e-01],
       [6.29130000e+00, 1.45982000e+16, 9.99309463e-01],
       [6.34200000e+00, 1.40314000e+16, 1.03609601e+00],
       [6.39270000e+00, 1.36553000e+16, 1.06218460e+00],
       [6.44350000e+00, 1.31735000e+16, 1.09774129e+00],
       [6.49420000e+00, 1.22518000e+16, 1.17381593e+00],
       [6.54500000e+00, 1.22405000e+16, 1.17489756e+00],
       [6.59570000e+00, 1.41710000e+16, 1.02683343e+00],
       [6.64640000e+00, 1.24652000e+16, 1.15504791e+00],
       [6.69720000e+00, 5.60531000e+15, 2.45810256e+00],
       [6.74790000e+00, 2.05069000e+15, 6.56447502e+00],
       [6.79860000e+00, 1.19840000e+15, 1.11737770e+01],
       [6.84940000e+00, 9.49074000e+14, 1.40863995e+01],
       [6.90010000e+00, 8.37915000e+14, 1.59477713e+01],
       [6.95080000e+00, 7.88315000e+14, 1.69433780e+01],
       [7.00160000e+00, 7.75354000e+14, 1.72266171e+01],
       [7.05230000e+00, 7.78574000e+14, 1.71553665e+01],
       [7.10300000e+00, 7.84513000e+14, 1.70255049e+01],
       [7.15380000e+00, 7.88678000e+14, 1.69355771e+01],
       [7.20450000e+00, 7.86683000e+14, 1.69785266e+01],
       [7.25530000e+00, 7.82168000e+14, 1.70765447e+01],
       [7.30600000e+00, 7.77857000e+14, 1.71711744e+01],
       [7.35670000e+00, 7.76068000e+14, 1.72107581e+01],
       [7.40750000e+00, 7.76426000e+14, 1.72028341e+01],
       [7.45820000e+00, 7.77141000e+14, 1.71869970e+01],
       [7.50890000e+00, 7.78216000e+14, 1.71632686e+01],
       [7.55970000e+00, 7.79651000e+14, 1.71316818e+01],
       [7.61040000e+00, 7.81628000e+14, 1.70883449e+01],
       [7.66110000e+00, 7.84152000e+14, 1.70333472e+01],
       [7.71190000e+00, 7.86865000e+14, 1.69746176e+01],
       [7.76260000e+00, 7.89223000e+14, 1.69277798e+01],
       [7.81340000e+00, 7.90861000e+14, 1.68888470e+01],
       [7.86410000e+00, 7.91589000e+14, 1.68732989e+01],
       [7.91480000e+00, 7.91043000e+14, 1.68888470e+01],
       [7.96560000e+00, 7.88678000e+14, 1.69355771e+01],
       [8.01630000e+00, 7.85055000e+14, 1.70137482e+01],
       [8.06700000e+00, 7.80369000e+14, 1.71119696e+01],
       [8.11780000e+00, 7.75532000e+14, 1.72226510e+01],
       [8.16850000e+00, 7.70903000e+14, 1.73260674e+01],
       [8.21920000e+00, 7.66479000e+14, 1.74260919e+01],
       [8.27000000e+00, 7.61904000e+14, 1.75266938e+01],
       [8.32070000e+00, 7.57879000e+14, 1.76238180e+01],
       [8.37150000e+00, 7.54050000e+14, 1.77092431e+01],
       [8.42220000e+00, 7.52315000e+14, 1.77541547e+01],
       [8.47290000e+00, 7.53009000e+14, 1.77337263e+01],
       [8.52370000e+00, 7.55788000e+14, 1.76685130e+01],
       [8.57440000e+00, 7.59801000e+14, 1.75792361e+01],
       [8.62510000e+00, 7.64892000e+14, 1.74582215e+01],
       [8.67590000e+00, 7.71259000e+14, 1.73141031e+01],
       [8.72660000e+00, 7.78037000e+14, 1.71672211e+01],
       [8.77730000e+00, 7.84332000e+14, 1.70294256e+01],
       [8.82810000e+00, 7.90679000e+14, 1.68927362e+01],
       [8.87880000e+00, 7.97076000e+14, 1.67571439e+01],
       [8.92950000e+00, 8.01863000e+14, 1.66571233e+01],
       [8.98030000e+00, 8.02971000e+14, 1.66341265e+01],
       [9.03100000e+00, 8.01309000e+14, 1.66686336e+01],
       [9.08180000e+00, 7.99466000e+14, 1.67070588e+01],
       [9.13250000e+00, 7.97444000e+14, 1.67494288e+01],
       [9.18320000e+00, 7.95426000e+14, 1.67919062e+01],
       [9.23400000e+00, 7.93597000e+14, 1.68306156e+01],
       [9.28470000e+00, 7.91589000e+14, 1.68732989e+01],
       [9.33540000e+00, 7.89587000e+14, 1.69160905e+01],
       [9.38620000e+00, 7.87590000e+14, 1.69589906e+01],
       [9.43690000e+00, 7.86140000e+14, 1.69902590e+01],
       [9.48760000e+00, 7.85597000e+14, 1.70019995e+01],
       [9.53840000e+00, 7.85236000e+14, 1.70098310e+01],
       [9.58910000e+00, 7.85055000e+14, 1.70137482e+01],
       [9.63990000e+00, 7.85055000e+14, 1.70137482e+01],
       [9.69060000e+00, 7.85597000e+14, 1.70019995e+01],
       [9.74130000e+00, 7.86865000e+14, 1.69746176e+01],
       [9.79210000e+00, 7.88860000e+14, 1.69316780e+01],
       [9.84280000e+00, 7.93597000e+14, 1.68344914e+01],
       [9.89350000e+00, 8.01124000e+14, 1.66763116e+01],
       [9.94430000e+00, 8.09841000e+14, 1.64968110e+01],
       [9.99500000e+00, 8.17900000e+14, 1.63342802e+01],
       [1.00457000e+01, 8.26228000e+14, 1.61696269e+01],
       [1.00965000e+01, 8.35218000e+14, 1.59992638e+01],
       [1.01472000e+01, 8.41008000e+14, 1.58891257e+01],
       [1.01979000e+01, 8.39653000e+14, 1.59110925e+01],
       [1.02487000e+01, 8.33681000e+14, 1.60287627e+01],
       [1.02994000e+01, 8.27942000e+14, 1.61361529e+01]])

data_c_ncal = np.array([[0.00000000e+00, 1.51845000e+19, 4.19662300e-03],
       [4.24000000e-02, 1.52440000e+19, 4.18311700e-03],
       [8.48000000e-02, 1.53250000e+19, 4.16389700e-03],
       [1.27200000e-01, 1.54241000e+19, 4.14190400e-03],
       [1.69600000e-01, 1.55203000e+19, 4.12002600e-03],
       [2.12000000e-01, 1.56171000e+19, 4.09920800e-03],
       [2.54400000e-01, 1.57145000e+19, 4.07755700e-03],
       [2.96800000e-01, 1.57725000e+19, 4.06536900e-03],
       [3.39200000e-01, 1.57652000e+19, 4.06724200e-03],
       [3.81600000e-01, 1.57072000e+19, 4.07943500e-03],
       [4.24000000e-01, 1.56171000e+19, 4.09920800e-03],
       [4.66400000e-01, 1.55239000e+19, 4.11907800e-03],
       [5.08800000e-01, 1.54383000e+19, 4.13904400e-03],
       [5.51200000e-01, 1.53462000e+19, 4.16006400e-03],
       [5.93600000e-01, 1.52511000e+19, 4.18119100e-03],
       [6.36000000e-01, 1.51845000e+19, 4.19662300e-03],
       [6.78400000e-01, 1.51530000e+19, 4.20436100e-03],
       [7.20800000e-01, 1.51461000e+19, 4.20532900e-03],
       [7.63200000e-01, 1.51635000e+19, 4.20145800e-03],
       [8.05600000e-01, 1.51391000e+19, 4.20726600e-03],
       [8.48000000e-01, 1.50453000e+19, 4.22863300e-03],
       [8.90400000e-01, 1.49279000e+19, 4.25598400e-03],
       [9.32800000e-01, 1.48081000e+19, 4.28548500e-03],
       [9.75200000e-01, 1.47163000e+19, 4.30724900e-03],
       [1.01760000e+00, 1.46656000e+19, 4.31916700e-03],
       [1.06000000e+00, 1.46352000e+19, 4.32713100e-03],
       [1.10240000e+00, 1.45881000e+19, 4.33810400e-03],
       [1.14480000e+00, 1.44344000e+19, 4.37723600e-03],
       [1.18720000e+00, 1.43021000e+19, 4.40960800e-03],
       [1.22960000e+00, 1.44644000e+19, 4.36918100e-03],
       [1.27200000e+00, 1.51321000e+19, 4.20823500e-03],
       [1.31440000e+00, 1.55597000e+19, 4.11149700e-03],
       [1.35680000e+00, 1.46251000e+19, 4.33012100e-03],
       [1.39920000e+00, 1.26009000e+19, 4.88652400e-03],
       [1.44160000e+00, 1.01485000e+19, 5.77963000e-03],
       [1.48400000e+00, 7.84152000e+18, 6.97429000e-03],
       [1.52640000e+00, 5.75572000e+18, 8.59805100e-03],
       [1.56880000e+00, 3.97832000e+18, 1.08243040e-02],
       [1.61120000e+00, 2.70520000e+18, 1.35331840e-02],
       [1.65360000e+00, 1.99710000e+18, 1.59955800e-02],
       [1.69600000e+00, 1.79184000e+18, 1.69550860e-02],
       [1.73840000e+00, 1.76238000e+18, 1.71080300e-02],
       [1.78080000e+00, 1.75995000e+18, 1.71198520e-02],
       [1.82320000e+00, 1.77092000e+18, 1.70647530e-02],
       [1.86560000e+00, 1.78033000e+18, 1.70176660e-02],
       [1.90800000e+00, 1.76848000e+18, 1.70765450e-02],
       [1.95040000e+00, 1.75590000e+18, 1.71435200e-02],
       [1.99280000e+00, 1.74462000e+18, 1.72028340e-02],
       [2.03520000e+00, 1.73420000e+18, 1.72583790e-02],
       [2.07760000e+00, 1.72584000e+18, 1.73021470e-02],
       [2.12000000e+00, 1.71870000e+18, 1.73380400e-02],
       [2.16240000e+00, 1.71080000e+18, 1.73820100e-02],
       [2.20480000e+00, 1.69473000e+18, 1.74702850e-02],
       [2.24720000e+00, 1.67109000e+18, 1.76035400e-02],
       [2.28960000e+00, 1.64172000e+18, 1.77664230e-02],
       [2.33200000e+00, 1.61027000e+18, 1.79514690e-02],
       [2.37440000e+00, 1.57870000e+18, 1.81426200e-02],
       [2.41680000e+00, 1.54953000e+18, 1.83231440e-02],
       [2.45920000e+00, 1.52125000e+18, 1.85012040e-02],
       [2.50160000e+00, 1.49451000e+18, 1.86766940e-02],
       [2.54400000e+00, 1.46825000e+18, 1.88538480e-02],
       [2.58640000e+00, 1.43483000e+18, 1.90809500e-02],
       [2.62880000e+00, 1.39508000e+18, 1.93686790e-02],
       [2.67120000e+00, 1.35176000e+18, 1.96924610e-02],
       [2.71360000e+00, 1.30497000e+18, 2.00585710e-02],
       [2.75600000e+00, 1.25285000e+18, 2.04927390e-02],
       [2.79840000e+00, 1.19564000e+18, 2.09990670e-02],
       [2.84080000e+00, 1.13240000e+18, 2.16023000e-02],
       [2.88320000e+00, 1.06611000e+18, 2.22946160e-02],
       [2.92560000e+00, 9.98619000e+17, 2.30674720e-02],
       [2.96800000e+00, 9.29180000e+17, 2.39496960e-02],
       [3.01040000e+00, 8.58223000e+17, 2.49689340e-02],
       [3.05280000e+00, 7.88134000e+17, 2.61035760e-02],
       [3.09520000e+00, 7.20775000e+17, 2.73463900e-02],
       [3.13760000e+00, 6.57052000e+17, 2.87078060e-02],
       [3.18000000e+00, 5.97448000e+17, 3.01786630e-02],
       [3.22240000e+00, 5.38022000e+17, 3.18933400e-02],
       [3.26480000e+00, 4.75007000e+17, 3.40878810e-02],
       [3.30720000e+00, 4.04203000e+17, 3.71791970e-02],
       [3.34960000e+00, 3.36744000e+17, 4.10771210e-02],
       [3.39200000e+00, 2.83204000e+17, 4.52376460e-02],
       [3.43440000e+00, 2.40104000e+17, 4.96821060e-02],
       [3.47680000e+00, 2.06063000e+17, 5.42875200e-02],
       [3.51920000e+00, 1.83696000e+17, 5.80898160e-02],
       [3.56160000e+00, 1.71435000e+17, 6.05480280e-02],
       [3.60400000e+00, 1.64248000e+17, 6.21441140e-02],
       [3.64640000e+00, 1.58635000e+17, 6.34599900e-02],
       [3.68880000e+00, 1.54775000e+17, 6.44169270e-02],
       [3.73120000e+00, 1.53038000e+17, 6.48783800e-02],
       [3.77360000e+00, 1.52686000e+17, 6.49531170e-02],
       [3.81600000e+00, 1.52651000e+17, 6.49680750e-02],
       [3.85840000e+00, 1.51985000e+17, 6.51478370e-02],
       [3.90080000e+00, 1.51112000e+17, 6.53732390e-02],
       [3.94320000e+00, 1.49417000e+17, 6.58263840e-02],
       [3.98560000e+00, 1.46859000e+17, 6.65426360e-02],
       [4.02800000e+00, 1.44145000e+17, 6.72976660e-02],
       [4.07040000e+00, 1.41579000e+17, 6.80612620e-02],
       [4.11280000e+00, 1.39284000e+17, 6.87543210e-02],
       [4.15520000e+00, 1.37246000e+17, 6.93745210e-02],
       [4.19760000e+00, 1.35457000e+17, 6.99519780e-02],
       [4.24000000e+00, 1.33444000e+17, 7.06154940e-02],
       [4.28240000e+00, 1.31280000e+17, 7.13345620e-02],
       [4.32480000e+00, 1.29181000e+17, 7.20609530e-02],
       [4.36720000e+00, 1.26707000e+17, 7.29457510e-02],
       [4.40960000e+00, 1.23424000e+17, 7.41651710e-02],
       [4.45200000e+00, 1.19179000e+17, 7.58402930e-02],
       [4.49440000e+00, 1.14657000e+17, 7.77320280e-02],
       [4.53680000e+00, 1.10255000e+17, 7.97260050e-02],
       [4.57920000e+00, 1.06194000e+17, 8.16770420e-02],
       [4.62160000e+00, 1.02612000e+17, 8.35218300e-02],
       [4.66400000e+00, 9.94260000e+16, 8.52707340e-02],
       [4.70640000e+00, 9.65162000e+16, 8.69560890e-02],
       [4.74880000e+00, 9.36268000e+16, 8.87156010e-02],
       [4.79120000e+00, 8.99083000e+16, 9.11590940e-02],
       [4.83360000e+00, 8.55855000e+16, 9.42106500e-02],
       [4.87600000e+00, 8.11335000e+16, 9.76787290e-02],
       [4.91840000e+00, 7.66655000e+16, 1.01531312e-01],
       [4.96080000e+00, 7.21107000e+16, 1.05925373e-01],
       [5.00320000e+00, 6.74217000e+16, 1.10994127e-01],
       [5.04560000e+00, 6.25605000e+16, 1.17030753e-01],
       [5.08800000e+00, 5.75307000e+16, 1.24251031e-01],
       [5.13040000e+00, 5.22878000e+16, 1.33168038e-01],
       [5.17280000e+00, 4.68490000e+16, 1.44410908e-01],
       [5.21520000e+00, 4.15145000e+16, 1.58124804e-01],
       [5.25760000e+00, 3.60413000e+16, 1.76238180e-01],
       [5.30000000e+00, 3.08745000e+16, 1.98975681e-01],
       [5.34240000e+00, 2.67609000e+16, 2.23048856e-01],
       [5.38480000e+00, 2.36157000e+16, 2.46944865e-01],
       [5.42720000e+00, 2.12178000e+16, 2.69836068e-01],
       [5.46960000e+00, 1.94267000e+16, 2.90469141e-01],
       [5.51200000e+00, 1.81635000e+16, 3.07397266e-01],
       [5.55440000e+00, 1.73540000e+16, 3.19521436e-01],
       [5.59680000e+00, 1.69044000e+16, 3.26738266e-01],
       [5.63920000e+00, 1.68112000e+16, 3.28322012e-01],
       [5.68160000e+00, 1.68267000e+16, 3.28019755e-01],
       [5.72400000e+00, 1.65882000e+16, 3.32047336e-01],
       [5.76640000e+00, 1.62967000e+16, 3.37132018e-01],
       [5.80880000e+00, 1.60103000e+16, 3.42294562e-01],
       [5.85120000e+00, 1.57181000e+16, 3.47776314e-01],
       [5.89360000e+00, 1.54454000e+16, 3.53101856e-01],
       [5.93600000e+00, 1.51845000e+16, 3.58261385e-01],
       [5.97840000e+00, 1.49073000e+16, 3.63998840e-01],
       [6.02080000e+00, 1.45781000e+16, 3.71107729e-01],
       [6.06320000e+00, 1.42102000e+16, 3.79402336e-01],
       [6.10560000e+00, 1.38516000e+16, 3.87882334e-01],
       [6.14800000e+00, 1.35114000e+16, 3.96460569e-01],
       [6.19040000e+00, 1.31826000e+16, 4.05041945e-01],
       [6.23280000e+00, 1.28499000e+16, 4.14285754e-01],
       [6.27520000e+00, 1.24796000e+16, 4.24912982e-01],
       [6.31760000e+00, 1.21116000e+16, 4.36314856e-01],
       [6.36000000e+00, 1.17842000e+16, 4.46992257e-01],
       [6.40240000e+00, 1.14736000e+16, 4.57614735e-01],
       [6.44480000e+00, 1.11455000e+16, 4.69461519e-01],
       [6.48720000e+00, 1.08268000e+16, 4.81836838e-01],
       [6.52960000e+00, 1.04064000e+16, 4.99114285e-01],
       [6.57200000e+00, 9.85372000e+15, 5.23962252e-01],
       [6.61440000e+00, 9.27897000e+15, 5.53095341e-01],
       [6.65680000e+00, 8.62383000e+15, 5.90744926e-01],
       [6.69920000e+00, 7.93232000e+15, 6.37235556e-01],
       [6.74160000e+00, 7.26942000e+15, 6.89922010e-01],
       [6.78400000e+00, 6.53281000e+15, 7.60851673e-01],
       [6.82640000e+00, 5.68068000e+15, 8.65764951e-01],
       [6.86880000e+00, 4.82281000e+15, 1.00809161e+00],
       [6.91120000e+00, 4.00498000e+15, 1.19977553e+00],
       [6.95360000e+00, 3.10456000e+15, 1.52580840e+00],
       [6.99600000e+00, 2.24802000e+15, 2.07586927e+00],
       [7.03840000e+00, 1.64399000e+15, 2.80349638e+00],
       [7.08080000e+00, 1.22067000e+15, 3.73766178e+00],
       [7.12320000e+00, 9.04690000e+14, 4.99919411e+00],
       [7.16560000e+00, 6.90558000e+14, 6.50429155e+00],
       [7.20800000e+00, 5.65588000e+14, 7.90132635e+00],
       [7.25040000e+00, 4.97164000e+14, 8.96189807e+00],
       [7.29280000e+00, 4.69137000e+14, 9.48636870e+00],
       [7.33520000e+00, 4.55512000e+14, 9.76337567e+00],
       [7.37760000e+00, 4.51232000e+14, 9.85371507e+00],
       [7.42000000e+00, 4.55512000e+14, 9.76337567e+00],
       [7.46240000e+00, 4.66015000e+14, 9.54772716e+00],
       [7.50480000e+00, 4.78961000e+14, 9.29608316e+00],
       [7.54720000e+00, 4.91473000e+14, 9.06358475e+00],
       [7.58960000e+00, 5.00265000e+14, 8.90840596e+00],
       [7.63200000e+00, 5.06058000e+14, 8.80846027e+00],
       [7.67440000e+00, 5.11564000e+14, 8.71565438e+00],
       [7.71680000e+00, 5.15466000e+14, 8.65167108e+00],
       [7.75920000e+00, 5.16654000e+14, 8.63177279e+00],
       [7.80160000e+00, 5.15585000e+14, 8.64967919e+00],
       [7.84400000e+00, 5.13925000e+14, 8.67760745e+00],
       [7.88640000e+00, 5.12389000e+14, 8.70362157e+00],
       [7.92880000e+00, 5.11564000e+14, 8.71565438e+00],
       [7.97120000e+00, 5.11564000e+14, 8.71766147e+00],
       [8.01360000e+00, 5.11446000e+14, 8.71766147e+00],
       [8.05600000e+00, 5.11446000e+14, 8.71966901e+00],
       [8.09840000e+00, 5.11329000e+14, 8.72167702e+00],
       [8.14080000e+00, 5.11093000e+14, 8.72368549e+00],
       [8.18320000e+00, 5.10975000e+14, 8.72770382e+00],
       [8.22560000e+00, 5.10740000e+14, 8.72971368e+00],
       [8.26800000e+00, 5.10623000e+14, 8.73373479e+00],
       [8.31040000e+00, 5.10387000e+14, 8.73775775e+00],
       [8.35280000e+00, 5.10035000e+14, 8.74178256e+00],
       [8.39520000e+00, 5.09683000e+14, 8.74782326e+00],
       [8.43760000e+00, 5.09331000e+14, 8.75185271e+00],
       [8.48000000e+00, 5.08745000e+14, 8.76395220e+00],
       [8.52240000e+00, 5.07925000e+14, 8.77808941e+00],
       [8.56480000e+00, 5.07107000e+14, 8.79022517e+00],
       [8.60720000e+00, 5.06874000e+14, 8.79629934e+00],
       [8.64960000e+00, 5.06874000e+14, 8.79427415e+00],
       [8.69200000e+00, 5.07107000e+14, 8.79224942e+00],
       [8.73440000e+00, 5.07107000e+14, 8.79022517e+00],
       [8.77680000e+00, 5.06874000e+14, 8.79427415e+00],
       [8.81920000e+00, 5.06641000e+14, 8.79832499e+00],
       [8.86160000e+00, 5.06407000e+14, 8.80237771e+00],
       [8.90400000e+00, 5.06291000e+14, 8.80440476e+00],
       [8.94640000e+00, 5.06407000e+14, 8.80237771e+00],
       [8.98880000e+00, 5.06524000e+14, 8.80035112e+00],
       [9.03120000e+00, 5.06757000e+14, 8.79629934e+00],
       [9.07360000e+00, 5.07107000e+14, 8.79224942e+00],
       [9.11600000e+00, 5.07341000e+14, 8.78617805e+00],
       [9.15840000e+00, 5.07809000e+14, 8.77808941e+00],
       [9.20080000e+00, 5.08276000e+14, 8.77000821e+00],
       [9.24320000e+00, 5.08745000e+14, 8.76395220e+00],
       [9.28560000e+00, 5.08276000e+14, 8.77000821e+00],
       [9.32800000e+00, 5.07107000e+14, 8.79224942e+00],
       [9.37040000e+00, 5.06058000e+14, 8.80846027e+00],
       [9.41280000e+00, 5.06058000e+14, 8.80846027e+00],
       [9.45520000e+00, 5.07107000e+14, 8.79224942e+00],
       [9.49760000e+00, 5.08276000e+14, 8.77000821e+00],
       [9.54000000e+00, 5.09565000e+14, 8.74983775e+00],
       [9.58240000e+00, 5.10740000e+14, 8.72971368e+00],
       [9.62480000e+00, 5.12153000e+14, 8.70562589e+00],
       [9.66720000e+00, 5.13689000e+14, 8.68160456e+00],
       [9.70960000e+00, 5.14873000e+14, 8.66163742e+00],
       [9.75200000e+00, 5.15229000e+14, 8.65565624e+00],
       [9.79440000e+00, 5.14991000e+14, 8.65964323e+00],
       [9.83680000e+00, 5.14754000e+14, 8.66163742e+00]])


data_c_CS01 = np.array([[1.39200000e-01, 2.56975506e+20],
       [1.45300000e-01, 2.62261825e+20],
       [1.51500000e-01, 2.67306554e+20],
       [1.57600000e-01, 2.71656483e+20],
       [1.63700000e-01, 2.72991426e+20],
       [1.69800000e-01, 2.74666262e+20],
       [1.76000000e-01, 2.73328037e+20],
       [1.82100000e-01, 2.72326827e+20],
       [1.88200000e-01, 2.71996332e+20],
       [1.94400000e-01, 2.71325562e+20],
       [2.00500000e-01, 2.70991417e+20],
       [2.06600000e-01, 2.69998765e+20],
       [2.12800000e-01, 2.68991298e+20],
       [2.18900000e-01, 2.67991321e+20],
       [2.25100000e-01, 2.66998752e+20],
       [2.31200000e-01, 2.67998756e+20],
       [2.37300000e-01, 2.68332920e+20],
       [2.43500000e-01, 2.67663757e+20],
       [2.49600000e-01, 2.66998752e+20],
       [2.55700000e-01, 2.66998752e+20],
       [2.61900000e-01, 2.67332918e+20],
       [2.68000000e-01, 2.66663746e+20],
       [2.74100000e-01, 2.72186970e+20],
       [2.80200000e-01, 2.79143642e+20],
       [2.86400000e-01, 2.85996512e+20],
       [2.92500000e-01, 2.80193064e+20],
       [2.98600000e-01, 2.73550901e+20],
       [3.04800000e-01, 2.68000000e+20],
       [3.10900000e-01, 2.74189295e+20],
       [3.17000000e-01, 2.81495569e+20],
       [3.23200000e-01, 2.88663969e+20],
       [3.29300000e-01, 2.90330657e+20],
       [3.35500000e-01, 2.89661690e+20],
       [3.41600000e-01, 2.90328348e+20],
       [3.47700000e-01, 2.89663979e+20],
       [3.53900000e-01, 2.83499034e+20],
       [3.60000000e-01, 2.76849462e+20],
       [3.66100000e-01, 2.70998770e+20],
       [3.72300000e-01, 2.71666257e+20],
       [3.78400000e-01, 2.72000000e+20],
       [3.84500000e-01, 2.72332926e+20],
       [3.90600000e-01, 2.72666259e+20],
       [3.96800000e-01, 2.72666259e+20],
       [4.02900000e-01, 2.72666259e+20],
       [4.09000000e-01, 2.71998775e+20],
       [4.15200000e-01, 2.71665033e+20],
       [4.21300000e-01, 2.68306654e+20],
       [4.27400000e-01, 2.63945897e+20],
       [4.33600000e-01, 2.45851685e+20],
       [4.39700000e-01, 2.04336958e+20],
       [4.45900000e-01, 1.48984248e+20],
       [4.52000000e-01, 1.02347781e+20],
       [4.58100000e-01, 7.17847222e+19],
       [4.64300000e-01, 5.40556776e+19],
       [4.70400000e-01, 4.34999850e+19],
       [4.76500000e-01, 3.85282595e+19],
       [4.82700000e-01, 3.56754942e+19],
       [4.88800000e-01, 3.44787552e+19],
       [4.94900000e-01, 3.31932336e+19],
       [5.01000000e-01, 3.22875081e+19],
       [5.07200000e-01, 3.17301501e+19],
       [5.13300000e-01, 3.07854347e+19],
       [5.19400000e-01, 2.99749124e+19],
       [5.25600000e-01, 2.90650304e+19],
       [5.31700000e-01, 2.90978352e+19],
       [5.37800000e-01, 2.91314744e+19],
       [5.44000000e-01, 2.94964853e+19],
       [5.50100000e-01, 2.93964964e+19],
       [5.56300000e-01, 2.94641526e+19],
       [5.62400000e-01, 2.91330667e+19],
       [5.68500000e-01, 2.90332951e+19],
       [5.74700000e-01, 2.90000000e+19],
       [5.80800000e-01, 2.92314807e+19],
       [5.86900000e-01, 3.01118822e+19],
       [5.93100000e-01, 3.09861485e+19],
       [5.99200000e-01, 3.16998948e+19],
       [6.05300000e-01, 3.15659972e+19],
       [6.11400000e-01, 3.16324521e+19],
       [6.17600000e-01, 3.13986240e+19],
       [6.23700000e-01, 3.14320268e+19],
       [6.29800000e-01, 3.13328715e+19],
       [6.36000000e-01, 3.12992525e+19],
       [6.42100000e-01, 3.06547718e+19],
       [6.48200000e-01, 3.00256078e+19],
       [6.54400000e-01, 2.96330711e+19],
       [6.60500000e-01, 2.96998878e+19],
       [6.66700000e-01, 2.95654973e+19],
       [6.72800000e-01, 2.95654973e+19],
       [6.78900000e-01, 2.98286079e+19],
       [6.85100000e-01, 3.01653023e+19],
       [6.91200000e-01, 3.03664103e+19],
       [6.97300000e-01, 3.02665200e+19],
       [7.03500000e-01, 3.01659661e+19],
       [7.09600000e-01, 3.03957483e+19],
       [7.15700000e-01, 3.06618078e+19],
       [7.21900000e-01, 3.09328655e+19],
       [7.28000000e-01, 3.09990322e+19],
       [7.34100000e-01, 3.10987083e+19],
       [7.40200000e-01, 3.14327694e+19],
       [7.46400000e-01, 3.24065332e+19],
       [7.52500000e-01, 3.33779630e+19],
       [7.58600000e-01, 3.45309967e+19],
       [7.64800000e-01, 3.38812489e+19],
       [7.70900000e-01, 3.31730742e+19],
       [7.77100000e-01, 3.26936272e+19],
       [7.83200000e-01, 3.29935855e+19],
       [7.89300000e-01, 3.35660371e+19],
       [7.95500000e-01, 3.40905912e+19],
       [8.01600000e-01, 3.48580526e+19],
       [8.07700000e-01, 3.55324562e+19],
       [8.13900000e-01, 3.71101291e+19],
       [8.20000000e-01, 3.82230789e+19],
       [8.26100000e-01, 3.87496337e+19],
       [8.32300000e-01, 3.47818072e+19],
       [8.38400000e-01, 2.71981851e+19],
       [8.44500000e-01, 1.91893713e+19],
       [8.50600000e-01, 1.31300582e+19],
       [8.56800000e-01, 9.43435108e+18],
       [8.62900000e-01, 7.20707792e+18],
       [8.69000000e-01, 5.79921353e+18],
       [8.75200000e-01, 5.01040394e+18],
       [8.81300000e-01, 4.60702330e+18],
       [8.87500000e-01, 4.54593204e+18],
       [8.93600000e-01, 4.56289463e+18],
       [8.99700000e-01, 4.45306778e+18],
       [9.05900000e-01, 4.41442750e+18],
       [9.12000000e-01, 4.41115513e+18],
       [9.18100000e-01, 4.34393378e+18],
       [9.24300000e-01, 4.23914066e+18],
       [9.30400000e-01, 4.10932178e+18],
       [9.36500000e-01, 4.12961506e+18],
       [9.42700000e-01, 4.04619927e+18],
       [9.48800000e-01, 4.07241020e+18],
       [9.54900000e-01, 4.14415672e+18],
       [9.61000000e-01, 4.07678891e+18],
       [9.67200000e-01, 4.02396626e+18],
       [9.73300000e-01, 3.83127113e+18],
       [9.79400000e-01, 3.94314770e+18],
       [9.85600000e-01, 3.90675752e+18],
       [9.91700000e-01, 4.07126628e+18],
       [9.97900000e-01, 4.13945803e+18],
       [1.00400000e+00, 4.15004492e+18],
       [1.01010000e+00, 4.04211470e+18],
       [1.01630000e+00, 3.95933937e+18],
       [1.02240000e+00, 3.99264068e+18],
       [1.02850000e+00, 4.04664743e+18],
       [1.03470000e+00, 4.09588155e+18],
       [1.04080000e+00, 4.10601991e+18],
       [1.04690000e+00, 4.16597026e+18],
       [1.05310000e+00, 4.20518170e+18],
       [1.05920000e+00, 4.29971164e+18],
       [1.06530000e+00, 4.19911675e+18],
       [1.07140000e+00, 4.12005569e+18],
       [1.07760000e+00, 3.99611740e+18],
       [1.08370000e+00, 4.01630015e+18],
       [1.08980000e+00, 3.99986666e+18],
       [1.09600000e+00, 3.96591030e+18],
       [1.10210000e+00, 3.91231035e+18],
       [1.10830000e+00, 3.90260234e+18],
       [1.11440000e+00, 3.84444797e+18],
       [1.12050000e+00, 3.86436775e+18],
       [1.12670000e+00, 3.68953924e+18],
       [1.13280000e+00, 3.33287976e+18],
       [1.13890000e+00, 2.91526662e+18],
       [1.14510000e+00, 2.56603232e+18],
       [1.15120000e+00, 2.46459087e+18],
       [1.15730000e+00, 2.36287426e+18],
       [1.16350000e+00, 2.33270661e+18],
       [1.16960000e+00, 2.29332849e+18],
       [1.17570000e+00, 2.25959817e+18],
       [1.18180000e+00, 2.21941900e+18],
       [1.18800000e+00, 2.12500272e+18],
       [1.19410000e+00, 2.07218561e+18],
       [1.20020000e+00, 2.06259202e+18],
       [1.20640000e+00, 2.12563589e+18],
       [1.21250000e+00, 2.16986174e+18],
       [1.21870000e+00, 2.16647662e+18],
       [1.22480000e+00, 2.13652148e+18],
       [1.23090000e+00, 2.12663004e+18],
       [1.23710000e+00, 2.12995290e+18],
       [1.24320000e+00, 2.18568446e+18],
       [1.24930000e+00, 2.16506357e+18],
       [1.25550000e+00, 2.21128308e+18],
       [1.26160000e+00, 2.12731306e+18],
       [1.26770000e+00, 2.16746048e+18],
       [1.27390000e+00, 2.09197999e+18],
       [1.28000000e+00, 2.13900644e+18],
       [1.28610000e+00, 2.12923915e+18],
       [1.29230000e+00, 2.21889023e+18],
       [1.29840000e+00, 2.28184728e+18],
       [1.30450000e+00, 2.30612407e+18],
       [1.31060000e+00, 2.25877084e+18],
       [1.31680000e+00, 2.21319236e+18],
       [1.32290000e+00, 2.20326760e+18],
       [1.32900000e+00, 2.23317986e+18],
       [1.33520000e+00, 2.24982115e+18],
       [1.34130000e+00, 2.30285550e+18],
       [1.34750000e+00, 2.21500745e+18],
       [1.35360000e+00, 2.15827280e+18],
       [1.35970000e+00, 2.01198141e+18],
       [1.36590000e+00, 2.07941798e+18],
       [1.37200000e+00, 2.10870941e+18],
       [1.37810000e+00, 2.15876515e+18],
       [1.38430000e+00, 2.04654663e+18],
       [1.39040000e+00, 1.99544128e+18],
       [1.39650000e+00, 1.99220718e+18],
       [1.40270000e+00, 2.05979057e+18],
       [1.40880000e+00, 2.09307241e+18],
       [1.41490000e+00, 2.10323312e+18],
       [1.42100000e+00, 2.10988896e+18],
       [1.42720000e+00, 2.08651801e+18],
       [1.43330000e+00, 2.03861369e+18],
       [1.43940000e+00, 1.96205082e+18],
       [1.44560000e+00, 1.87576609e+18],
       [1.45170000e+00, 1.87898353e+18],
       [1.45790000e+00, 1.90512926e+18],
       [1.46400000e+00, 1.89804693e+18],
       [1.47010000e+00, 1.81674558e+18],
       [1.47630000e+00, 1.77587058e+18],
       [1.48240000e+00, 1.81491314e+18],
       [1.48850000e+00, 1.79704866e+18],
       [1.49470000e+00, 1.77061764e+18],
       [1.50080000e+00, 1.77061764e+18],
       [1.50690000e+00, 1.80548123e+18],
       [1.51310000e+00, 1.75628002e+18],
       [1.51920000e+00, 1.61958837e+18],
       [1.52530000e+00, 1.54572028e+18],
       [1.53140000e+00, 1.54572028e+18],
       [1.53760000e+00, 1.49939175e+18],
       [1.54370000e+00, 1.46256134e+18],
       [1.54980000e+00, 1.37632291e+18],
       [1.55600000e+00, 1.32008264e+18],
       [1.56210000e+00, 1.23402607e+18],
       [1.56830000e+00, 1.19307118e+18],
       [1.57440000e+00, 1.19307118e+18],
       [1.58050000e+00, 1.16138163e+18],
       [1.58670000e+00, 1.12537173e+18],
       [1.59280000e+00, 1.08987766e+18],
       [1.59890000e+00, 1.03598865e+18],
       [1.60510000e+00, 9.89781022e+17],
       [1.61120000e+00, 9.07811378e+17],
       [1.61730000e+00, 9.09454776e+17],
       [1.62350000e+00, 9.34442154e+17],
       [1.62960000e+00, 9.08546002e+17],
       [1.63570000e+00, 8.45241041e+17],
       [1.64180000e+00, 7.79007100e+17],
       [1.64800000e+00, 7.77323846e+17],
       [1.65410000e+00, 7.18682033e+17],
       [1.66020000e+00, 6.78274564e+17],
       [1.66640000e+00, 6.51629637e+17],
       [1.67250000e+00, 6.27472679e+17],
       [1.67870000e+00, 5.46689675e+17],
       [1.68480000e+00, 4.73688757e+17],
       [1.69090000e+00, 4.40778191e+17],
       [1.69710000e+00, 4.07082280e+17],
       [1.70320000e+00, 3.86450636e+17],
       [1.70930000e+00, 3.72557783e+17],
       [1.71550000e+00, 3.62272586e+17],
       [1.72160000e+00, 3.28275726e+17],
       [1.72770000e+00, 2.67035555e+17],
       [1.73390000e+00, 2.39231710e+17],
       [1.74000000e+00, 2.21556781e+17],
       [1.74610000e+00, 2.08492914e+17],
       [1.75220000e+00, 1.70866168e+17],
       [1.75840000e+00, 1.33567664e+17],
       [1.76450000e+00, 1.16222719e+17],
       [1.77060000e+00, 9.55967460e+16],
       [1.77680000e+00, 8.02085890e+16],
       [1.78290000e+00, 5.12400037e+16],
       [1.78910000e+00, 4.75887458e+16],
       [1.79520000e+00, 3.07817046e+16],
       [1.80130000e+00, 3.07817046e+16],
       [1.80750000e+00, 3.07817046e+16],
       [1.81360000e+00, 3.07817046e+16],
       [1.81970000e+00, 3.07817046e+16],
       [1.82590000e+00, 3.07817046e+16],
       [1.83200000e+00, 3.07817046e+16],
       [1.83810000e+00, 3.06916554e+16],
       [1.84430000e+00, 3.05715258e+16],
       [1.85040000e+00, 3.03617355e+16],
       [1.85650000e+00, 2.99879013e+16],
       [1.86270000e+00, 2.95582297e+16],
       [1.86880000e+00, 2.91453213e+16],
       [1.87490000e+00, 2.87504925e+16],
       [1.88100000e+00, 2.83417580e+16],
       [1.88720000e+00, 2.79351730e+16],
       [1.89330000e+00, 2.76075779e+16],
       [1.89950000e+00, 2.74123399e+16],
       [1.90560000e+00, 2.73837019e+16],
       [1.91170000e+00, 2.75007357e+16],
       [1.91790000e+00, 2.76642179e+16],
       [1.92400000e+00, 2.78718269e+16],
       [1.93010000e+00, 2.81158546e+16],
       [1.93630000e+00, 2.85660509e+16],
       [1.94240000e+00, 2.91098878e+16],
       [1.94850000e+00, 2.96556825e+16],
       [1.95470000e+00, 3.00150800e+16],
       [1.96080000e+00, 3.02910847e+16],
       [1.96690000e+00, 3.05109582e+16],
       [1.97310000e+00, 3.06260044e+16],
       [1.97920000e+00, 3.04914719e+16],
       [1.98530000e+00, 3.02115161e+16],
       [1.99140000e+00, 2.98416617e+16],
       [1.99760000e+00, 2.95839997e+16],
       [2.00370000e+00, 2.94502228e+16],
       [2.00990000e+00, 2.94260573e+16],
       [2.01600000e+00, 2.94112217e+16],
       [2.02210000e+00, 2.93672452e+16],
       [2.02830000e+00, 2.92881044e+16],
       [2.03440000e+00, 2.92101836e+16],
       [2.04050000e+00, 2.89733697e+16],
       [2.04670000e+00, 2.85239655e+16],
       [2.05280000e+00, 2.78788552e+16],
       [2.05890000e+00, 2.70814597e+16],
       [2.06510000e+00, 2.62008416e+16],
       [2.07120000e+00, 2.52564671e+16],
       [2.07730000e+00, 2.43420160e+16],
       [2.08350000e+00, 2.34073975e+16],
       [2.08960000e+00, 2.24583819e+16],
       [2.09570000e+00, 2.14650932e+16],
       [2.10180000e+00, 2.06100517e+16],
       [2.10800000e+00, 1.98347261e+16],
       [2.11410000e+00, 1.92226861e+16],
       [2.12030000e+00, 1.87150593e+16],
       [2.12640000e+00, 1.84444348e+16],
       [2.13250000e+00, 1.82679165e+16],
       [2.13870000e+00, 1.82732734e+16],
       [2.14480000e+00, 1.82935440e+16],
       [2.15090000e+00, 1.84348347e+16],
       [2.15710000e+00, 1.83839090e+16],
       [2.16320000e+00, 1.82152267e+16],
       [2.16930000e+00, 1.79442828e+16],
       [2.17550000e+00, 1.77916737e+16],
       [2.18160000e+00, 1.76097814e+16],
       [2.18770000e+00, 1.74642496e+16],
       [2.19390000e+00, 1.72545156e+16],
       [2.20000000e+00, 1.72704990e+16],
       [2.20610000e+00, 1.72844377e+16],
       [2.21220000e+00, 1.74221351e+16],
       [2.21840000e+00, 1.74763533e+16],
       [2.22450000e+00, 1.76275693e+16],
       [2.23070000e+00, 1.77685643e+16],
       [2.23680000e+00, 1.80775078e+16],
       [2.24290000e+00, 1.84535178e+16],
       [2.24910000e+00, 1.89864574e+16],
       [2.25520000e+00, 1.94216535e+16],
       [2.26130000e+00, 1.99703877e+16],
       [2.26750000e+00, 2.05180470e+16],
       [2.27360000e+00, 2.10441462e+16],
       [2.27970000e+00, 2.12336123e+16],
       [2.28590000e+00, 2.11765007e+16],
       [2.29200000e+00, 2.09982249e+16],
       [2.29810000e+00, 2.09170928e+16],
       [2.30430000e+00, 2.07890875e+16],
       [2.31040000e+00, 2.06508290e+16],
       [2.31650000e+00, 2.04911833e+16],
       [2.32260000e+00, 2.04337670e+16],
       [2.32880000e+00, 2.04119041e+16],
       [2.33490000e+00, 2.04619535e+16],
       [2.34110000e+00, 2.04107502e+16],
       [2.34720000e+00, 2.02863348e+16],
       [2.35330000e+00, 2.01727376e+16],
       [2.35950000e+00, 2.02484418e+16],
       [2.36560000e+00, 2.05872233e+16],
       [2.37170000e+00, 2.10383926e+16],
       [2.37790000e+00, 2.14928098e+16],
       [2.38400000e+00, 2.18738796e+16],
       [2.39010000e+00, 2.21626387e+16],
       [2.39630000e+00, 2.21921675e+16],
       [2.40240000e+00, 2.19970281e+16],
       [2.40850000e+00, 2.15253653e+16],
       [2.41470000e+00, 2.10128273e+16],
       [2.42080000e+00, 2.04691604e+16],
       [2.42690000e+00, 2.00176780e+16],
       [2.43300000e+00, 1.95772287e+16],
       [2.43920000e+00, 1.91748806e+16],
       [2.44530000e+00, 1.86829744e+16],
       [2.45140000e+00, 1.82036191e+16],
       [2.45760000e+00, 1.76751589e+16],
       [2.46370000e+00, 1.71760091e+16],
       [2.46990000e+00, 1.66063509e+16],
       [2.47600000e+00, 1.61785052e+16],
       [2.48210000e+00, 1.58507923e+16],
       [2.48830000e+00, 1.57626164e+16],
       [2.49440000e+00, 1.57235775e+16],
       [2.50050000e+00, 1.57011865e+16],
       [2.50670000e+00, 1.56070190e+16],
       [2.51280000e+00, 1.55732803e+16],
       [2.51890000e+00, 1.55686406e+16],
       [2.52510000e+00, 1.56560877e+16],
       [2.53120000e+00, 1.56621348e+16],
       [2.53730000e+00, 1.56263712e+16],
       [2.54350000e+00, 1.55576368e+16],
       [2.54960000e+00, 1.55602956e+16],
       [2.55570000e+00, 1.55926613e+16],
       [2.56180000e+00, 1.55312388e+16],
       [2.56800000e+00, 1.53189311e+16],
       [2.57410000e+00, 1.50964460e+16],
       [2.58030000e+00, 1.49744459e+16],
       [2.58640000e+00, 1.49692215e+16],
       [2.59250000e+00, 1.49361563e+16],
       [2.59870000e+00, 1.48155628e+16],
       [2.60480000e+00, 1.46467557e+16],
       [2.61090000e+00, 1.44702139e+16],
       [2.61710000e+00, 1.42445753e+16],
       [2.62320000e+00, 1.39515082e+16],
       [2.62930000e+00, 1.36390459e+16],
       [2.63550000e+00, 1.34265950e+16],
       [2.64160000e+00, 1.33543036e+16],
       [2.64770000e+00, 1.33180676e+16],
       [2.65390000e+00, 1.32204159e+16],
       [2.66610000e+00, 1.30189791e+16],
       [2.67220000e+00, 1.28347613e+16],
       [2.67840000e+00, 1.26852697e+16],
       [2.68450000e+00, 1.25375193e+16],
       [2.69070000e+00, 1.23548446e+16],
       [2.69680000e+00, 1.22498600e+16],
       [2.70910000e+00, 1.23240336e+16],
       [2.72130000e+00, 1.25672578e+16],
       [2.72750000e+00, 1.27875433e+16],
       [2.73360000e+00, 1.28745755e+16],
       [2.73970000e+00, 1.27930358e+16],
       [2.74590000e+00, 1.26851859e+16],
       [2.75200000e+00, 1.25516063e+16],
       [2.75810000e+00, 1.24479384e+16],
       [2.76430000e+00, 1.23368691e+16],
       [2.77040000e+00, 1.22861932e+16],
       [2.77650000e+00, 1.23086484e+16],
       [2.78260000e+00, 1.24361249e+16],
       [2.78880000e+00, 1.25936657e+16],
       [2.79490000e+00, 1.27256456e+16],
       [2.80110000e+00, 1.27747762e+16],
       [2.80720000e+00, 1.28327283e+16],
       [2.81330000e+00, 1.28668126e+16],
       [2.81950000e+00, 1.29145733e+16],
       [2.82560000e+00, 1.29239829e+16],
       [2.83170000e+00, 1.29173714e+16],
       [2.83790000e+00, 1.29226864e+16],
       [2.84400000e+00, 1.28879577e+16],
       [2.85010000e+00, 1.28478426e+16],
       [2.85630000e+00, 1.28072534e+16],
       [2.86240000e+00, 1.27851861e+16],
       [2.86850000e+00, 1.27853415e+16],
       [2.87470000e+00, 1.28458540e+16],
       [2.88080000e+00, 1.29258525e+16],
       [2.88690000e+00, 1.30638686e+16],
       [2.89300000e+00, 1.32033584e+16],
       [2.89920000e+00, 1.34414678e+16],
       [2.90530000e+00, 1.36787285e+16],
       [2.91150000e+00, 1.39109186e+16],
       [2.92380000e+00, 1.39736823e+16],
       [2.92990000e+00, 1.39916122e+16],
       [2.93600000e+00, 1.38417840e+16],
       [2.94210000e+00, 1.36333196e+16],
       [2.94830000e+00, 1.33010569e+16],
       [2.95440000e+00, 1.28782286e+16],
       [2.96050000e+00, 1.28782286e+16],
       [2.96670000e+00, 1.28782286e+16]])

data_c_ppsc2 = np.array([[0.00000000e+00, 6.35769955e-04, 1.87068214e+20],
       [1.03400000e-01, 6.85172620e-04, 1.73220784e+20],
       [2.06900000e-01, 7.24102422e-04, 1.63719346e+20],
       [3.10300000e-01, 7.55440041e-04, 1.56711187e+20],
       [4.13800000e-01, 7.98730006e-04, 1.48013047e+20],
       [5.17200000e-01, 8.76193445e-04, 1.34493099e+20],
       [6.20600000e-01, 1.05511549e-03, 1.10968573e+20],
       [7.24100000e-01, 1.30226689e-03, 8.90430444e+19],
       [8.27500000e-01, 1.53603107e-03, 7.48169501e+19],
       [9.30900000e-01, 1.80717413e-03, 6.29361250e+19],
       [1.03440000e+00, 2.10959943e-03, 5.32843902e+19],
       [1.13780000e+00, 2.40436280e-03, 4.62168136e+19],
       [1.24130000e+00, 2.63815313e-03, 4.17541839e+19],
       [1.34470000e+00, 2.96346635e-03, 3.67028678e+19],
       [1.44810000e+00, 3.46577209e-03, 3.07751374e+19],
       [1.55160000e+00, 4.04296517e-03, 2.58107129e+19],
       [1.65500000e+00, 4.76979814e-03, 2.12911932e+19],
       [1.75850000e+00, 5.70689655e-03, 1.71949137e+19],
       [1.86190000e+00, 7.00970918e-03, 1.33690331e+19],
       [1.96530000e+00, 9.22146665e-03, 9.43626220e+18],
       [2.06880000e+00, 1.31401402e-02, 5.87759964e+18],
       [2.17220000e+00, 1.84629035e-02, 3.63915036e+18],
       [2.27560000e+00, 2.39552110e-02, 2.48198984e+18],
       [2.37910000e+00, 2.87276433e-02, 1.88755667e+18],
       [2.48250000e+00, 3.35042577e-02, 1.49279441e+18],
       [2.58600000e+00, 3.79664508e-02, 1.23083546e+18],
       [2.68940000e+00, 4.21308285e-02, 1.04761088e+18],
       [2.79280000e+00, 4.63340219e-02, 9.03649474e+17],
       [2.89630000e+00, 5.12625257e-02, 7.72324834e+17],
       [2.99970000e+00, 5.72664155e-02, 6.49980010e+17],
       [3.10320000e+00, 6.49381632e-02, 5.34933751e+17],
       [3.20660000e+00, 7.57181510e-02, 4.22279501e+17],
       [3.31000000e+00, 9.97929819e-02, 2.77779377e+17],
       [3.41350000e+00, 1.37784384e-01, 1.72862186e+17],
       [3.51690000e+00, 1.84714079e-01, 1.14287833e+17],
       [3.62030000e+00, 2.25372021e-01, 8.72368549e+16],
       [3.72380000e+00, 2.39662453e-01, 8.03896245e+16],
       [3.82720000e+00, 2.40879588e-01, 7.98730006e+16],
       [3.93070000e+00, 2.46660723e-01, 7.73927003e+16],
       [4.03410000e+00, 2.49344619e-01, 7.63132589e+16],
       [4.13750000e+00, 2.51825671e-01, 7.53182117e+16],
       [4.24100000e+00, 2.70707320e-01, 6.85488226e+16],
       [4.34440000e+00, 3.48979567e-01, 4.96249406e+16],
       [4.44790000e+00, 4.70652099e-01, 3.44587881e+16],
       [4.55130000e+00, 6.31684179e-01, 2.44174327e+16],
       [4.65470000e+00, 8.58420341e-01, 1.72663285e+16],
       [4.75820000e+00, 1.04712855e+00, 1.38707518e+16],
       [4.86160000e+00, 1.14182619e+00, 1.26211811e+16],
       [4.96500000e+00, 1.20976217e+00, 1.18576875e+16],
       [5.06850000e+00, 1.26095620e+00, 1.13396591e+16],
       [5.17190000e+00, 1.30707347e+00, 1.09093783e+16],
       [5.27540000e+00, 1.32617245e+00, 1.07423674e+16],
       [5.37880000e+00, 1.31129378e+00, 1.08717636e+16],
       [5.48220000e+00, 1.25458474e+00, 1.14024979e+16],
       [5.58570000e+00, 1.12434605e+00, 1.28351220e+16],
       [5.68910000e+00, 1.05462971e+00, 1.37625845e+16],
       [5.79260000e+00, 1.37372563e+00, 1.03442736e+16],
       [5.89600000e+00, 2.85495982e+00, 4.80064951e+15],
       [5.99940000e+00, 7.17133483e+00, 1.87499451e+15],
       [6.10290000e+00, 1.17057704e+01, 1.14366808e+15],
       [6.20630000e+00, 1.45512399e+01, 9.18544075e+14],
       [6.30970000e+00, 1.52124793e+01, 8.78415519e+14],
       [6.41320000e+00, 1.51914770e+01, 8.79832499e+14],
       [6.51660000e+00, 1.51495593e+01, 8.82266928e+14],
       [6.62010000e+00, 1.51251608e+01, 8.83690121e+14],
       [6.72350000e+00, 1.51600279e+01, 8.81454704e+14],
       [6.82690000e+00, 1.52580839e+01, 8.75790036e+14],
       [6.93040000e+00, 1.53886315e+01, 8.68360380e+14],
       [7.03380000e+00, 1.55453319e+01, 8.59607112e+14],
       [7.13730000e+00, 1.57072444e+01, 8.50746165e+14],
       [7.24070000e+00, 1.57979233e+01, 8.45668200e+14],
       [7.34410000e+00, 1.58452830e+01, 8.43140595e+14],
       [7.44760000e+00, 1.58927847e+01, 8.40814127e+14],
       [7.55100000e+00, 1.56855590e+01, 8.51726187e+14],
       [7.65440000e+00, 1.51077573e+01, 8.84708093e+14],
       [7.75790000e+00, 1.43582001e+01, 9.31107875e+14],
       [7.86130000e+00, 1.36144468e+01, 9.82200159e+14],
       [7.96480000e+00, 1.28233058e+01, 1.04327788e+15],
       [8.06820000e+00, 1.14208914e+01, 1.17246530e+15],
       [8.17160000e+00, 9.18121167e+00, 1.46083108e+15],
       [8.27510000e+00, 6.08135001e+00, 2.21615433e+15],
       [8.37850000e+00, 3.20036859e+00, 4.26776011e+15],
       [8.48200000e+00, 1.37720947e+00, 1.03181064e+16],
       [8.58540000e+00, 5.19397674e-01, 3.06549068e+16],
       [8.68880000e+00, 1.92530705e-01, 1.07969229e+17],
       [8.79230000e+00, 7.45761570e-02, 4.32314697e+17],
       [8.89570000e+00, 3.64837944e-02, 1.30918192e+18],
       [8.99910000e+00, 2.35504928e-02, 2.54565766e+18],
       [9.10260000e+00, 1.84799163e-02, 3.63412616e+18],
       [9.20600000e+00, 1.62742132e-02, 4.35913180e+18],
       [9.30950000e+00, 1.48867536e-02, 4.94310687e+18],
       [9.41290000e+00, 1.46419864e-02, 5.05941146e+18],
       [9.51630000e+00, 1.45915020e-02, 5.08393513e+18],
       [9.61980000e+00, 1.45478897e-02, 5.10505000e+18],
       [9.72320000e+00, 1.45244602e-02, 5.11681836e+18],
       [9.82670000e+00, 1.45077479e-02, 5.12507234e+18],
       [9.93010000e+00, 1.44943919e-02, 5.13215778e+18],
       [1.00335000e+01, 1.44777142e-02, 5.14043652e+18],
       [1.01370000e+01, 1.44577263e-02, 5.14872860e+18],
       [1.02404000e+01, 1.44344420e-02, 5.16059765e+18],
       [1.03438000e+01, 1.44111952e-02, 5.17368520e+18],
       [1.04473000e+01, 1.43879858e-02, 5.18441788e+18],
       [1.05507000e+01, 1.43912991e-02, 5.18203092e+18],
       [1.06542000e+01, 1.44311187e-02, 5.16297474e+18],
       [1.07576000e+01, 1.44843830e-02, 5.13688685e+18],
       [1.08610000e+01, 1.45445403e-02, 5.10622562e+18],
       [1.09645000e+01, 1.46521042e-02, 5.05475371e+18],
       [1.10679000e+01, 1.47604637e-02, 5.00264862e+18],
       [1.11714000e+01, 1.48149435e-02, 4.97737085e+18],
       [1.12748000e+01, 1.48047132e-02, 4.98195729e+18],
       [1.13782000e+01, 1.47672627e-02, 4.99919411e+18],
       [1.14817000e+01, 1.47163463e-02, 5.02458271e+18],
       [1.15851000e+01, 1.46588533e-02, 5.05126322e+18],
       [1.16885000e+01, 1.45948622e-02, 5.08276464e+18],
       [1.17920000e+01, 1.45211162e-02, 5.11799668e+18],
       [1.18954000e+01, 1.44477427e-02, 5.15347294e+18],
       [1.19989000e+01, 1.43879858e-02, 5.18322426e+18],
       [1.21023000e+01, 1.43681218e-02, 5.19397674e+18],
       [1.22057000e+01, 1.43846732e-02, 5.18561178e+18],
       [1.23092000e+01, 1.43979281e-02, 5.17964506e+18],
       [1.24126000e+01, 1.43714305e-02, 5.19278092e+18],
       [1.25161000e+01, 1.42988134e-02, 5.22877555e+18],
       [1.26195000e+01, 1.42167393e-02, 5.27108476e+18],
       [1.27229000e+01, 1.41709837e-02, 5.29419581e+18],
       [1.28264000e+01, 1.41873081e-02, 5.28688666e+18],
       [1.29298000e+01, 1.42331164e-02, 5.26259562e+18],
       [1.30332000e+01, 1.42724983e-02, 5.24203601e+18],
       [1.31367000e+01, 1.42724983e-02, 5.24324317e+18],
       [1.32401000e+01, 1.42527937e-02, 5.25291048e+18],
       [1.33436000e+01, 1.42265633e-02, 5.26623215e+18],
       [1.34470000e+01, 1.42101938e-02, 5.27472716e+18],
       [1.35504000e+01, 1.42036512e-02, 5.27837207e+18],
       [1.36539000e+01, 1.42036512e-02, 5.27715682e+18],
       [1.37573000e+01, 1.42134662e-02, 5.27229861e+18],
       [1.38608000e+01, 1.42396725e-02, 5.25896160e+18],
       [1.39642000e+01, 1.43086941e-02, 5.22396189e+18],
       [1.40676000e+01, 1.43946132e-02, 5.18083785e+18],
       [1.41711000e+01, 1.44577263e-02, 5.14991428e+18],
       [1.42745000e+01, 1.44843830e-02, 5.13570418e+18],
       [1.43779000e+01, 1.44977298e-02, 5.12979488e+18],
       [1.44814000e+01, 1.44943919e-02, 5.13097620e+18],
       [1.45848000e+01, 1.44743810e-02, 5.14162028e+18],
       [1.46883000e+01, 1.44444164e-02, 5.15584675e+18],
       [1.47917000e+01, 1.44012437e-02, 5.17845254e+18],
       [1.48951000e+01, 1.43284760e-02, 5.21434785e+18],
       [1.49986000e+01, 1.42101938e-02, 5.27472716e+18],
       [1.51020000e+01, 1.40604752e-02, 5.35303398e+18],
       [1.52055000e+01, 1.39027272e-02, 5.43750914e+18]])


data_c_npsc2 = np.array([[0.00000000e+00, 1.05754779e-03, 6.93266157e+19],
       [1.04400000e-01, 1.04279754e-03, 7.04206452e+19],
       [2.08900000e-01, 9.61612278e-04, 7.70371132e+19],
       [3.13300000e-01, 9.90603824e-04, 7.45246594e+19],
       [4.17800000e-01, 1.46960290e-03, 4.84506938e+19],
       [5.22200000e-01, 2.58642566e-03, 2.63390435e+19],
       [6.26600000e-01, 4.21696503e-03, 1.50973249e+19],
       [7.31100000e-01, 5.42875197e-03, 1.10204670e+19],
       [8.35500000e-01, 6.76705958e-03, 8.18464788e+18],
       [9.40000000e-01, 8.43140595e-03, 5.92925325e+18],
       [1.04440000e+00, 1.18494993e-02, 3.41350073e+18],
       [1.14880000e+00, 1.77133213e-02, 1.65120122e+18],
       [1.25330000e+00, 2.00631906e-02, 1.30436759e+18],
       [1.35770000e+00, 2.13550209e-02, 1.15797718e+18],
       [1.46220000e+00, 2.26777519e-02, 1.03204825e+18],
       [1.56660000e+00, 2.38231947e-02, 9.38858192e+17],
       [1.67100000e+00, 2.51941668e-02, 8.43334758e+17],
       [1.77550000e+00, 2.69215462e-02, 7.42848071e+17],
       [1.87990000e+00, 2.89134556e-02, 6.48186527e+17],
       [1.98440000e+00, 3.14485047e-02, 5.52713408e+17],
       [2.08880000e+00, 3.45939378e-02, 4.61955349e+17],
       [2.19320000e+00, 3.85034815e-02, 3.78965784e+17],
       [2.29770000e+00, 4.32513831e-02, 3.06831540e+17],
       [2.40210000e+00, 4.86855410e-02, 2.48713867e+17],
       [2.50660000e+00, 5.48403225e-02, 2.02534961e+17],
       [2.61100000e+00, 6.16736994e-02, 1.66264680e+17],
       [2.71540000e+00, 7.01132341e-02, 1.34958425e+17],
       [2.81990000e+00, 7.95426398e-02, 1.10636900e+17],
       [2.92430000e+00, 8.87769049e-02, 9.35405674e+16],
       [3.02880000e+00, 1.03347506e-01, 7.47308634e+16],
       [3.13320000e+00, 1.42200132e-01, 4.78299581e+16],
       [3.23760000e+00, 2.31046822e-01, 2.56271317e+16],
       [3.34210000e+00, 3.92012576e-01, 1.36867395e+16],
       [3.44650000e+00, 4.87640761e-01, 1.06807070e+16],
       [3.55090000e+00, 5.29297692e-01, 9.74316371e+15],
       [3.65540000e+00, 5.60402417e-01, 9.14323748e+15],
       [3.75980000e+00, 5.98136080e-01, 8.50746165e+15],
       [3.86430000e+00, 6.20297456e-01, 8.17146641e+15],
       [3.96870000e+00, 6.67882401e-01, 7.53355564e+15],
       [4.07310000e+00, 8.36372992e-01, 5.89657735e+15],
       [4.17760000e+00, 1.34338347e+00, 3.55140335e+15],
       [4.28200000e+00, 2.43444518e+00, 1.90414493e+15],
       [4.38650000e+00, 3.74110588e+00, 1.21983194e+15],
       [4.49090000e+00, 4.30625754e+00, 1.05487257e+15],
       [4.59530000e+00, 4.65478901e+00, 9.73643570e+14],
       [4.69980000e+00, 4.89215265e+00, 9.25124111e+14],
       [4.80420000e+00, 5.05475371e+00, 8.94540484e+14],
       [4.90870000e+00, 5.25170110e+00, 8.60003067e+14],
       [5.01310000e+00, 5.46764111e+00, 8.25087485e+14],
       [5.11750000e+00, 5.85463736e+00, 7.69130440e+14],
       [5.22200000e+00, 6.46100385e+00, 6.95184371e+14],
       [5.32640000e+00, 7.40286790e+00, 6.04644351e+14],
       [5.43090000e+00, 9.26616437e+00, 4.80507311e+14],
       [5.53530000e+00, 1.33721118e+01, 3.30445620e+14],
       [5.63970000e+00, 2.27876741e+01, 1.91955252e+14],
       [5.74420000e+00, 4.54988060e+01, 9.50167125e+13],
       [5.84860000e+00, 8.65565624e+01, 4.94766174e+13],
       [5.95310000e+00, 1.41026264e+02, 3.01647687e+13],
       [6.05750000e+00, 2.05731125e+02, 2.05731125e+13],
       [6.16190000e+00, 2.54741675e+02, 1.65691412e+13],
       [6.26640000e+00, 2.77332010e+02, 1.52019745e+13],
       [6.37080000e+00, 2.86351854e+02, 1.47163463e+13],
       [6.47530000e+00, 2.86220015e+02, 1.47265155e+13],
       [6.57970000e+00, 2.77715424e+02, 1.51844827e+13],
       [6.68410000e+00, 2.66931606e+02, 1.58015613e+13],
       [6.78860000e+00, 2.53804899e+02, 1.66302968e+13],
       [6.89300000e+00, 2.43108420e+02, 1.73740073e+13],
       [6.99750000e+00, 2.33776041e+02, 1.80759029e+13],
       [7.10190000e+00, 2.24439866e+02, 1.88364909e+13],
       [7.20630000e+00, 2.13402744e+02, 1.98243976e+13],
       [7.31080000e+00, 2.01697261e+02, 2.09893988e+13],
       [7.41520000e+00, 1.90589952e+02, 2.22330989e+13],
       [7.51970000e+00, 1.79928517e+02, 2.35667666e+13],
       [7.62410000e+00, 1.69785266e+02, 2.49919418e+13],
       [7.72850000e+00, 1.60213829e+02, 2.65094062e+13],
       [7.83300000e+00, 1.50938490e+02, 2.81578830e+13],
       [7.93740000e+00, 1.41416473e+02, 3.00815354e+13],
       [8.04190000e+00, 1.31856031e+02, 3.22923760e+13],
       [8.14630000e+00, 1.23310483e+02, 3.45620903e+13],
       [8.25070000e+00, 1.15797718e+02, 3.68383356e+13],
       [8.35520000e+00, 1.07176606e+02, 3.98474010e+13],
       [8.45960000e+00, 9.80392545e+01, 4.36013564e+13],
       [8.56410000e+00, 8.91456180e+01, 4.80286080e+13],
       [8.66850000e+00, 8.03896245e+01, 5.33334895e+13],
       [8.77290000e+00, 7.26607707e+01, 5.91017037e+13],
       [8.87740000e+00, 6.56749877e+01, 6.54786927e+13],
       [8.98180000e+00, 5.86948504e+01, 7.34006659e+13],
       [9.08630000e+00, 5.17249405e+01, 8.34257270e+13],
       [9.19070000e+00, 4.51336025e+01, 9.58296716e+13],
       [9.29510000e+00, 3.90211442e+01, 1.11096404e+14],
       [9.39960000e+00, 3.35274096e+01, 1.29628352e+14],
       [9.50400000e+00, 2.87872381e+01, 1.51356125e+14],
       [9.60840000e+00, 2.46944865e+01, 1.76888663e+14],
       [9.71290000e+00, 2.09266639e+01, 2.09363032e+14],
       [9.81730000e+00, 1.71395731e+01, 2.56566530e+14],
       [9.92180000e+00, 1.38739460e+01, 3.18199872e+14],
       [1.00262000e+01, 1.10611428e+01, 4.00959031e+14],
       [1.01306000e+01, 8.72569443e+00, 5.10975409e+14],
       [1.02351000e+01, 6.70347509e+00, 6.69422029e+14],
       [1.03395000e+01, 4.82169794e+00, 9.38858192e+14],
       [1.04440000e+01, 3.45859732e+00, 1.32281771e+15],
       [1.05484000e+01, 2.46263473e+00, 1.88104853e+15],
       [1.06528000e+01, 1.53073496e+00, 3.09456778e+15],
       [1.07573000e+01, 8.89610704e-01, 5.51569191e+15],
       [1.08617000e+01, 5.09565481e-01, 1.01671680e+16],
       [1.09662000e+01, 2.79962588e-01, 2.03001852e+16],
       [1.10706000e+01, 1.38292937e-01, 4.96706679e+16],
       [1.11750000e+01, 6.74528028e-02, 1.43615065e+17],
       [1.12795000e+01, 3.87703749e-02, 3.74196740e+17],
       [1.13839000e+01, 3.00676856e-02, 6.01727694e+17],
       [1.14884000e+01, 2.71831637e-02, 7.29289566e+17],
       [1.15928000e+01, 2.62663665e-02, 7.78394933e+17],
       [1.16972000e+01, 2.58226019e-02, 8.04451749e+17],
       [1.18017000e+01, 2.58642566e-02, 8.02047335e+17],
       [1.19061000e+01, 2.59477676e-02, 7.97076491e+17],
       [1.20106000e+01, 2.61276290e-02, 7.86683425e+17],
       [1.21150000e+01, 2.62603192e-02, 7.79112191e+17],
       [1.22194000e+01, 2.62482286e-02, 7.79471068e+17],
       [1.23239000e+01, 2.62301032e-02, 7.80728440e+17],
       [1.24283000e+01, 2.62603192e-02, 7.79112191e+17],
       [1.25328000e+01, 2.62845169e-02, 7.77499288e+17],
       [1.26372000e+01, 2.62845169e-02, 7.77499288e+17],
       [1.27416000e+01, 2.62724153e-02, 7.78394933e+17],
       [1.28461000e+01, 2.61878594e-02, 7.83249272e+17],
       [1.29505000e+01, 2.61818301e-02, 7.83429643e+17],
       [1.30550000e+01, 2.62966242e-02, 7.76783514e+17],
       [1.31594000e+01, 2.61818301e-02, 7.83429643e+17],
       [1.32638000e+01, 2.60855501e-02, 7.89041780e+17],
       [1.33683000e+01, 2.61095869e-02, 7.87589649e+17],
       [1.34727000e+01, 2.61396639e-02, 7.85778244e+17],
       [1.35772000e+01, 2.61758022e-02, 7.83610055e+17],
       [1.36816000e+01, 2.62119904e-02, 7.81627805e+17],
       [1.37860000e+01, 2.61878594e-02, 7.83068943e+17],
       [1.38905000e+01, 2.61155995e-02, 7.87408321e+17],
       [1.39949000e+01, 2.60255550e-02, 7.92501330e+17],
       [1.40994000e+01, 2.59836406e-02, 7.94877127e+17],
       [1.42038000e+01, 2.59597198e-02, 7.96159350e+17],
       [1.43082000e+01, 2.59597198e-02, 7.96342694e+17],
       [1.44127000e+01, 2.59597198e-02, 7.96342694e+17],
       [1.45171000e+01, 2.58761703e-02, 8.01308962e+17],
       [1.46216000e+01, 2.57869513e-02, 8.06491882e+17],
       [1.47260000e+01, 2.62905699e-02, 7.77141319e+17],
       [1.48304000e+01, 2.67670186e-02, 7.51103871e+17],
       [1.49349000e+01, 2.67239100e-02, 7.53182117e+17],
       [1.50393000e+01, 2.60255550e-02, 7.92318871e+17]])

# Data storage
data_lib = {


    "pcal":{
        "resistivity_allowed":True,
        "data_cc":np.c_[data_c_pcal[:,0],data_c_pcal[:,1]],
        "data_res":np.c_[data_c_pcal[:,0],data_c_pcal[:,2]],
    },
    "ncal":{
        "resistivity_allowed":True,
        "data_cc":np.c_[data_c_ncal[:,0],data_c_ncal[:,1]],
        "data_res":np.c_[data_c_ncal[:,0],data_c_ncal[:,2]],
    },
    "CS01":{
        "resistivity_allowed":False,
        "data_cc":np.c_[data_c_CS01[:,0],data_c_CS01[:,1]],
    },
    "pcs1":{
        "resistivity_allowed":True,
        "data_cc":np.c_[data_c_pcs1[:,0],data_c_pcs1[:,1]],
        "data_res":np.c_[data_c_pcs1[:,0],data_c_pcs1[:,2]],
    },
    "ppsc2":{
        "resistivity_allowed":True,
        "data_cc":np.c_[data_c_ppsc2[:,0],data_c_ppsc2[:,2]],
        "data_res":np.c_[data_c_ppsc2[:,0],data_c_ppsc2[:,1]],
    },
    "npsc1":{
        "resistivity_allowed":True,
        "data_cc":np.c_[data_c_npsc1[:,0],data_c_npsc1[:,1]],
        "data_res":np.c_[data_c_npsc1[:,0],data_c_npsc1[:,2]],
    },
    "npsc2":{
        "resistivity_allowed":True,
        "data_cc":np.c_[data_c_npsc2[:,0],data_c_npsc2[:,2]],
        "data_res":np.c_[data_c_npsc2[:,0],data_c_npsc2[:,1]],
    },
    "Own Sample":{
        "resistivity_allowed":True,
        "data_cc":None,
        "data_res":None
    }
}

preset_lib = {
    "pcal":{
        "Charge carriers -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":1,
            "-dopant_type-":"B",
            "-num_steps-":5,
            "-step_distance-":1,
            "-stretch-":[-5,5],
            "-fitpoints-":[0,0,0,0],
            '-scale_cal-':False
        },
        "Resistivity -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":2,
            "-dopant_type-":"B",
            "-num_steps-":5,
            "-step_distance-":1,
            "-stretch-":[-5,5],
            "-fitpoints-":[0,0,0,0],
            '-scale_cal-':False
        },
    },
    "pcs1":{
        "Charge carriers -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":1,
            "-dopant_type-":"B",
            "-num_steps-":7,
            "-step_distance-":0.3,
            "-stretch-":[0,8],
            "-fitpoints-":[0,0,0,0,0,0],
            '-scale_cal-':False
        },
        "Resistivity -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":2,
            "-dopant_type-":"B",
            "-num_steps-":7,
            "-step_distance-":0.3,
            "-stretch-":[0,8],
            "-fitpoints-":[0,0,0,0,0,0],
            '-scale_cal-':False
        },
     },
    "npsc2":{
        "Charge carriers -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":1,
            "-dopant_type-":"As",
            "-num_steps-":5,
            "-step_distance-":0.3,
            "-stretch-":[0,8],
            "-fitpoints-":[0,0,0,0,0,0],
            '-scale_cal-':False
        },

        "Resistivity -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":2,
            "-dopant_type-":"As",
            "-num_steps-":5,
            "-step_distance-":0.3,
            "-stretch-":[0,8],
            "-fitpoints-":[0,0,0,0,0,0],
            '-scale_cal-':False
        },
    
    },
    "npsc1":{
        "Charge carriers -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":1,
            "-dopant_type-":"As",
            "-num_steps-":7,
            "-step_distance-":0.3,
            "-stretch-":[0,8],
            "-fitpoints-":[0,0,0,0,0,0],
            '-scale_cal-':False
        },

        "Resistivity -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":2,
            "-dopant_type-":"As",
            "-num_steps-":7,
            "-step_distance-":0.3,
            "-stretch-":[0,8],
            "-fitpoints-":[0,0,0,0,0,0],
            '-scale_cal-':False
        },
    
    },
    "ppsc2":{
        "Charge carriers -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":1,
            "-dopant_type-":"B",
            "-num_steps-":5,
            "-step_distance-":0.6,
            "-stretch-":[-5,5],
            "-fitpoints-":[0,0,0,0,0,0],
            '-scale_cal-':False
        },
        "Resistivity -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":2,
            "-dopant_type-":"B",
            "-num_steps-":5,
            "-step_distance-":0.6,
            "-stretch-":[-5,5],
            "-fitpoints-":[0,0,0,0,0,0],
            '-scale_cal-':False
        },
    },
    "ncal":{
        "Charge carriers -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":1,
            "-dopant_type-":"As",
            "-num_steps-":5,
            "-step_distance-":1,
            "-stretch-":[5,12],
            "-fitpoints-":[0,1,2,2],
            '-scale_cal-':False
        },
        "Resistivity -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":2,
            "-dopant_type-":"As",
            "-num_steps-":5,
            "-step_distance-":1,
            "-stretch-":[5,12],
            "-fitpoints-":[0,1,2,2],
            '-scale_cal-':False
        },

    },
    "CS01":{
        "Charge carriers -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":1,
            "-dopant_type-":"As",
            "-num_steps-":5,
            "-step_distance-":0.2,
            "-stretch-":[-5,5],
            "-fitpoints-":[0,0,0,0],
            '-scale_cal-':False
        },
    },
    "Own Sample":{
        "Charge carriers -- default":{
            "-flip_cal_data-":False,
            "-cal_setting-":1,
            "-dopant_type-":"As",
            "-num_steps-":5,
            "-step_distance-":1,
            "-stretch-":[-5,5],
            "-fitpoints-":[0,0,0,0],
            '-scale_cal-':False
         }
    }
}



#############################################################################################################################
#############################################################################################################################


class SelectCalibrationTab:
    """Controller for the 'Select Calibration File' tab functionality."""
    def __init__(self, ui, main_window):
        """Initialize the tab with UI elements and data attributes."""
        self.ui = ui
        self.main_window = main_window
    
        # Initialize matplotlib figure and canvas
        self.figure = Figure()
        self.canvas = FigureCanvas(self.figure)
        try:
            self.ui.CalibTab_verticalLayout.addWidget(self.canvas)
        except AttributeError as e:
            print(f"Error: {e}. Ensure CalibTab_verticalLayout exists.")
            raise SystemExit(1)
    
        # Data attributes
        self.X_data = np.array([])
        self.Y_data = np.array([])
        self.X_data_range = np.array([])
        self.borders_data = [0, 0]
        self.original_borders_data = [0, 0]
        self.data_is_flipped = False
        self.calibration_file = ""
        self.G_data_separators = [";", " ", "\t", ","]
        self.G_cal_setting = 1
        self.denomination = "Unspecified quantity [abbr. Units]"
        self.scale_cal_data = False
        self.G_carrier_type = "B"
        self.G_step_distance = 0.3
        self.G_number_of_steps = 7
    
        # Settings for storing last directory
        self.settings = QSettings("MyApp", "Calibration")
        self.last_directory = self.settings.value("last_directory", "", type=str)
    
        # Initialize UI elements
        self.ui.calib_sample_combobox.addItems(["pcal", "pcs1", "npsc2", "npsc1", "ppsc2", "ncal", "CS01", "Own Sample"])
        self.ui.calib_sample_combobox.setCurrentText("pcal")
        self.ui.Calib_Data_Type_comboBox.addItems(["charge carrier density", "resistivity", "Other"])
        self.ui.Dopant_Type_comboBox.addItems(["P", "As", "B"])  # Add dopant types
        self.ui.Dopant_type_label.setText("p-type" if self.G_carrier_type == "B" else "n-type")  # Set initial label
        self.ui.calibration_data_lineEdit.setVisible(False)
        self.ui.browse_button.setVisible(False)
        self.ui.Calibratio_data_label.setVisible(False)
        self.ui.Raw_data_linear_scale.setVisible(False)
        self.ui.RawData_LinearScale_checkBox.setVisible(False)
        self.ui.label_11.setVisible(False)
        self.ui.Calib_Data_Type_comboBox.setVisible(False)
        self.ui.Calib_Data_Type_label.setVisible(False)
        self.ui.Calib_Data_Denom_label.setVisible(False)
        self.ui.Calib_Data_Denom_lineEdit.setVisible(False)
        self.ui.Dopant_Type_comboBox.setVisible(False)
        self.ui.Dopant_type_label.setVisible(False)
        self.ui.Calib_Data_Denom_lineEdit.setText(self.denomination)
        self.ui.Nb_steps_spinBox.setValue(self.G_number_of_steps)
        self.ui.Min_Step_LineEdit.setText(str(self.G_step_distance))
    
        # Connect signals to slots
        self.ui.calib_sample_combobox.currentTextChanged.connect(self.update_calibration_sample)
        self.ui.Preset_comboBox.currentTextChanged.connect(self.update_preset_from_combo)
        self.ui.browse_button.clicked.connect(self.browse_calibration_file)
        self.ui.RawData_LinearScale_checkBox.stateChanged.connect(self.update_scale)
        self.ui.Flip_Data_Checkbox.stateChanged.connect(self.flip_data)
        self.ui.Calib_Data_Type_comboBox.currentTextChanged.connect(self.update_data_type)
        self.ui.Calib_Data_Denom_lineEdit.textChanged.connect(self.update_denomination)
        self.ui.leftBorderSlider_2.valueChanged.connect(self.change_left_border)
        self.ui.rightBorderSlider_2.valueChanged.connect(self.change_right_border)
        self.ui.Nb_steps_spinBox.valueChanged.connect(self.update_number_of_steps)
        self.ui.Min_Step_LineEdit.textEdited.connect(self.update_step_distance)
        self.ui.apply_parameters_calib_tab_Button.clicked.connect(self.apply_parameters)
        self.ui.Dopant_Type_comboBox.currentTextChanged.connect(self.update_dopant_type)  # New connection
        
        
        # Initialize UI
        #self.update_calibration_sample("pcal")

    def browse_calibration_file(self):
        """Open file dialog to select a calibration file."""
        initial_dir = self.last_directory
        file_path, _ = QFileDialog.getOpenFileName(
            self.main_window, "Select Calibration File", initial_dir, "Text Files (*.txt)"
        )
        if file_path:
            print(f"Selected file: {file_path}")  # Debug: Log file path
            self.calibration_file = file_path
            self.last_directory = os.path.dirname(file_path)
            self.settings.setValue("last_directory", self.last_directory)
            self.ui.calibration_data_lineEdit.setText(file_path)
            if not self.import_data(file_path):
                print("Failed to import data from file")  # Debug: Log import failure

    def import_data(self, path_data):
        """Import XY data from a text file with various delimiters."""
        print(f"Attempting to load file: {path_data}")
        if not os.path.exists(path_data):
            print(f"Error: File does not exist: {path_data}")
            QMessageBox.critical(self.main_window, "Error", f"File does not exist: {path_data}")
            return False
        if not os.access(path_data, os.R_OK):
            print(f"Error: File is not readable: {path_data}")
            QMessageBox.critical(self.main_window, "Error", f"File is not readable: {path_data}")
            return False
    
        # Preview first few lines for debugging
        try:
            with open(path_data, 'r') as f:
                lines = f.readlines()[:5]
                print("File preview (first 5 lines):")
                for i, line in enumerate(lines):
                    print(f"Line {i+1}: {line.strip()}")
        except Exception as e:
            print(f"Error reading file preview: {str(e)}")
    
        successful_data_import = False
        data = None
        # Try whitespace delimiter first (handles multiple spaces/tabs)
        try:
            print("Trying delimiter: auto (whitespace)")
            data = np.loadtxt(path_data, delimiter=None, skiprows=1, usecols=(0, 1))
            print(f"Data shape after load: {data.shape}")
            if len(data.shape) != 2 or data.shape[1] != 2:
                raise ValueError(f"Expected 2 columns, got shape {data.shape}")
            successful_data_import = True
        except Exception as e:
            print(f"Failed with auto delimiter: {str(e)}")
    
        # Fallback to other delimiters if needed
        if not successful_data_import:
            for delim in self.G_data_separators:
                print(f"Trying delimiter: '{delim}'")
                try:
                    data = np.loadtxt(path_data, delimiter=delim, skiprows=1, usecols=(0, 1))
                    print(f"Data shape after load: {data.shape}")
                    if len(data.shape) != 2 or data.shape[1] != 2:
                        raise ValueError(f"Expected 2 columns, got shape {data.shape}")
                    successful_data_import = True
                    break
                except Exception as e:
                    print(f"Failed with delimiter '{delim}': {str(e)}")
                    continue
    
        if successful_data_import:
            try:
                if not np.all(np.isfinite(data)):
                    raise ValueError("Data contains non-numeric or invalid values")
                data[:, 0] = data[:, 0] * 1e6  # Convert X to m
                X = data[:, 0] - np.min(data[:, 0])  # Normalize X to start at 0
                Y = data[:, 1]
                if X.size < 2 or Y.size < 2:
                    raise ValueError(f"Data has too few points: X={X.size}, Y={Y.size}")
                X_range = np.abs(X[-1] - X[0])
                print(f"X range: {X_range} m")
                while X_range < 0.1:  # Ensure reasonable range
                    X = X * 1e3
                    X = X - np.min(X)
                    X_range = np.abs(X[-1] - X[0])
                    print(f"Scaled X range: {X_range} m")
                if not self.scale_cal_data:
                    Y = np.where(Y > 0, np.log10(Y), np.nan)
                    print(f"Y data after log scale: min={np.nanmin(Y)}, max={np.nanmax(Y)}")
                self.X_data = X
                self.Y_data = Y
                self.X_data_range = X.copy()
                self.borders_data = [X[0], X[-1]]
                self.original_borders_data = self.borders_data.copy()
                self.data_is_flipped = False
                self.ui.calibration_data_lineEdit.setText(path_data)
                self.reset_data_window()
                self.redraw_data_preview()
                self.path_data = path_data
                print("Data imported successfully")
                QMessageBox.information(self.main_window, "Success", "Calibration data imported successfully!")
                return True
            except Exception as e:
                print(f"Data processing error: {str(e)}")
                QMessageBox.critical(self.main_window, "Error", f"Calibration data cannot be read: {str(e)}")
                return False
        else:
            print("Error: Failed to read file with any delimiter")
            QMessageBox.critical(self.main_window, "Error", "Calibration data cannot be read: No valid delimiter found")
            return False

    def update_calibration_sample(self, sample):
        """Update UI based on calibration sample selection."""
        self.ui.Preset_comboBox.clear()
        if sample == "CS01":
            self.ui.Preset_comboBox.addItems(["Charge carriers -- default"])
        else:
            self.ui.Preset_comboBox.addItems(["Charge carriers -- default", "Resistivity -- default"])
        is_own_sample = sample == "Own Sample"
        self.ui.Preset_label.setVisible(not is_own_sample)
        self.ui.Preset_comboBox.setVisible(not is_own_sample)
        self.ui.Calibratio_data_label.setVisible(is_own_sample)  # Fixed typo
        self.ui.calibration_data_lineEdit.setVisible(is_own_sample)
        self.ui.browse_button.setVisible(is_own_sample)
        self.ui.Raw_data_linear_scale.setVisible(is_own_sample)
        self.ui.RawData_LinearScale_checkBox.setVisible(is_own_sample)
        self.ui.label_11.setVisible(is_own_sample)
        self.ui.Calib_Data_Type_comboBox.setVisible(is_own_sample)
        self.ui.Calib_Data_Type_label.setVisible(is_own_sample)
        self.ui.Calib_Data_Denom_label.setVisible(is_own_sample)
        self.ui.Calib_Data_Denom_lineEdit.setVisible(is_own_sample)

        self.ui.Dopant_Type_label.setVisible(is_own_sample)
        self.ui.Dopant_Type_comboBox.setVisible(is_own_sample)
        self.ui.Dopant_type_label.setVisible(is_own_sample)
        self.ui.apply_parameters_calib_tab_Button.setEnabled(False)
        if not is_own_sample:
            self.ui.Preset_comboBox.setCurrentText("Charge carriers -- default")
            self.update_preset_from_combo("Charge carriers -- default")
        else:
            self.ui.Calib_Data_Type_comboBox.setCurrentText("charge carrier density")
        self.ui.Nb_steps_spinBox.setValue(self.G_number_of_steps)  # Update spin box
        self.ui.Min_Step_LineEdit.setText(str(self.G_step_distance))  # Update line edit
        self.redraw_data_preview()
        self.main_window.alignment_tab.reset_calibration_state()

    
    def update_preset_from_combo(self, preset_name):
        """Wrapper to pass sample and preset_name to update_preset."""
        sample = self.ui.calib_sample_combobox.currentText()
        self.main_window.alignment_tab.reset_calibration_state()
        self.update_preset(sample, preset_name)
        
    
    def update_preset(self, sample, preset_name):
        """Load preset settings and data, updating stretch sliders in AlignmentTab."""
        if sample not in preset_lib or preset_name not in preset_lib[sample]:
            return
        preset = preset_lib[sample][preset_name]
        self.data_is_flipped = preset["-flip_cal_data-"]
        self.G_cal_setting = preset["-cal_setting-"]
        self.scale_cal_data = preset["-scale_cal-"]
        self.G_dopant_type = preset["-dopant_type-"]
        self.G_carrier_type = preset["-dopant_type-"]
        self.G_step_distance = preset["-step_distance-"]
        self.G_number_of_steps = preset["-num_steps-"]
        # Set path_data for preset samples
        #self.path_data = f"preset_{sample}_{preset_name}"  # Unique identifier for preset
        if sample != "Own Sample":
            if self.G_cal_setting == 1:
                data = data_lib[sample]["data_cc"]
            elif self.G_cal_setting == 2:
                data = data_lib[sample]["data_res"]
            else:
                data = data_lib[sample]["data_cc"]
            X = data[:, 0] * 1e6  # Convert to m
            X = X - np.min(X)
            Y = data[:, 1]
            X_range = np.abs(X[-1] - X[0])
            while X_range < 0.1:
                X = X * 1e3
                X = X - np.min(X)
                X_range = np.abs(X[-1] - X[0])
            if not self.scale_cal_data:
                Y = np.where(Y > 0, np.log10(Y), np.nan)
            self.X_data = X
            self.Y_data = Y
            self.X_data_range = X.copy()
            self.borders_data = [X[0], X[-1]]
            self.original_borders_data = self.borders_data.copy()
        self.ui.Flip_Data_Checkbox.setChecked(self.data_is_flipped)
        self.ui.Calib_Data_Type_comboBox.setCurrentText(
            "charge carrier density" if self.G_cal_setting == 1 else
            "resistivity" if self.G_cal_setting == 2 else "Other"
        )
        self.ui.Calib_Data_Denom_lineEdit.setVisible(self.G_cal_setting == 3)
        self.ui.RawData_LinearScale_checkBox.setChecked(self.scale_cal_data)
        self.ui.Dopant_Type_comboBox.setCurrentText(self.G_carrier_type)
        self.ui.Dopant_type_label.setText("p-type" if self.G_carrier_type == "B" else "n-type")
        self.ui.Nb_steps_spinBox.setValue(self.G_number_of_steps)
        self.ui.Min_Step_LineEdit.setText(str(self.G_step_distance))
        # Update stretch sliders in AlignmentTab
        try:
            stretch_values = preset["-stretch-"]
            alignment_tab = self.main_window.alignment_tab
            alignment_tab.ui.minStretch_slider.setValue(int(stretch_values[0]))
            alignment_tab.ui.MaxStretch_slider.setValue(int(stretch_values[1]))
            print(f"Stretch sliders updated: min={stretch_values[0]}, max={stretch_values[1]}")
        except AttributeError as e:
            print(f"Error updating stretch sliders: {e}. Ensure main_window.alignment_tab exists.")
        self.reset_data_window()
        self.redraw_data_preview()
        self.ui.apply_parameters_calib_tab_Button.setEnabled(True)
        self.G_cal_setting = self.G_cal_setting
        print("G_cal_settingggggggggg:", self.G_cal_setting)

    def update_scale(self, state):
        """Toggle linear/logarithmic scale and reload data."""
        self.scale_cal_data = state == Qt.Checked
        if self.ui.calib_sample_combobox.currentText() == "Own Sample" and self.calibration_file:
            self.import_data(self.calibration_file)
        else:
            self.ui.Preset_comboBox.setCurrentText(self.ui.Preset_comboBox.currentText())
        self.ui.apply_parameters_calib_tab_Button.setEnabled(True)

    def update_data_type(self, data_type):
        """Update calibration data type and visibility of denomination."""
        if data_type == "charge carrier density":
            self.G_cal_setting = 1
            self.G_carrier_type = "B" # Default for charge carrier densityy
        elif data_type == "resistivity":
            self.G_cal_setting = 2
            self.G_carrier_type = "P"  # Default for resistivity
        else:
            self.G_cal_setting = 3
            self.G_carrier_type = "P"  # Default for other
        self.ui.Calib_Data_Denom_lineEdit.setVisible(self.G_cal_setting == 3)
        self.ui.Dopant_Type_comboBox.setCurrentText(self.G_carrier_type)  # Update combo box
        self.ui.Dopant_type_label.setText("p-type" if self.G_carrier_type == "B" else "n-type")  # Update label
        self.ui.apply_parameters_calib_tab_Button.setEnabled(True)
        self.redraw_data_preview()
 
    def update_dopant_type(self, dopant_type):
        """Update G_carrier_type and Dopant_type_label based on Dopant_Type_comboBox."""
        self.G_carrier_type = dopant_type
        self.ui.Dopant_type_label.setText("p-type" if dopant_type == "B" else "n-type")
        print(f"Dopant type updated: {self.G_carrier_type}, Label: {self.ui.Dopant_type_label.text()}")
        self.ui.apply_parameters_calib_tab_Button.setEnabled(True)
        self.redraw_data_preview()

    def update_denomination(self, text):
        """Update denomination for 'Other' data type."""
        self.denomination = text
        self.ui.apply_parameters_calib_tab_Button.setEnabled(True)
        self.redraw_data_preview()

    def update_slider_label_position(self, slider, label, value):
        """Update the position of a slider's value label to follow the handle."""
        min_val = slider.minimum()
        max_val = slider.maximum()
        slider_width = slider.width()
        handle_width = 10
        if max_val > min_val:
            fraction = (value - min_val) / (max_val - min_val)
            x_offset = int(fraction * (slider_width - handle_width)) + slider.x()
            label.setGeometry(x_offset - 30, label.y(), 60, 20)

    def change_left_border(self, value):
        """Update left border based on slider value in steps of 0.01."""
        if self.X_data.size > 0:
            min_val = min(self.X_data)
    
            # Map slider value to dataset range
            left_border = min_val + value * 0.01
    
            # Apply updated left border
            self.borders_data[0] = left_border
            if not self.data_is_flipped:
                self.original_borders_data[0] = self.borders_data[0]
    
            # Update labels
            self.ui.rightMinLabel_2.setText(f"{self.borders_data[0] * 1e-6:.3f} mm")
            self.ui.leftSliderValueLabel_2.setText(f"{self.borders_data[0] * 1e-6:.2f}")
            self.update_slider_label_position(self.ui.leftBorderSlider_2, self.ui.leftSliderValueLabel_2, value)
            self.main_window.alignment_tab.reset_calibration_state()
            # Enable the apply parameters button
            self.ui.apply_parameters_calib_tab_Button.setEnabled(True)
    

    
    def change_right_border(self, value):
        """Update right border based on slider value in steps of 0.01."""
        if self.X_data.size > 0:
            min_val = min(self.X_data)
    
            # Map slider value to dataset range
            right_border = min_val + value * 0.01
    
            # Apply updated right border
            self.borders_data[1] = right_border
            if not self.data_is_flipped:
                self.original_borders_data[1] = self.borders_data[1]
            
            self.main_window.alignment_tab.reset_calibration_state()
            # Update labels
            self.ui.leftMaxLabel_2.setText(f"{self.borders_data[1] * 1e-6:.3f} mm")
            self.ui.rightSliderValueLabel_2.setText(f"{self.borders_data[1] * 1e-6:.2f}")
            self.update_slider_label_position(self.ui.rightBorderSlider_2, self.ui.rightSliderValueLabel_2, value)
    
            # Enable the apply parameters button
            self.ui.apply_parameters_calib_tab_Button.setEnabled(True)
    
    
            
    
    def update_number_of_steps(self, value):
        """Update G_number_of_steps from Nb_steps_spinBox and enable apply button."""
        self.G_number_of_steps = max(1, int(value))  # Ensure >= 1
        print(f"Number of steps updated: {self.G_number_of_steps}")
        self.main_window.alignment_tab.reset_calibration_state()

        self.ui.apply_parameters_calib_tab_Button.setEnabled(True)

    def update_step_distance(self, text):
        """Update G_step_distance from Min_Step_LineEdit for valid input."""
        if text.strip():  # Only process non-empty input
            try:
                step_distance = float(text)
                if step_distance > 0:
                    self.G_step_distance = step_distance
                    print(f"Step distance updated: {self.G_step_distance}")
                else:
                    print(f"Negative step distance input: {text}, keeping previous value: {self.G_step_distance}")
            except (ValueError, TypeError):
                print(f"Invalid step distance input: {text}, keeping previous value: {self.G_step_distance}")
        else:
            print(f"Empty step distance input, keeping previous value: {self.G_step_distance}")
        
        self.main_window.alignment_tab.reset_calibration_state()
        self.ui.apply_parameters_calib_tab_Button.setEnabled(True)

    def reset_data_window(self):
        """Reset sliders to fixed steps of 0.01."""
        if self.X_data.size > 0:
            min_val = min(self.X_data)
            max_val = max(self.X_data)
    
            # Total slider steps for 0.01 increments
            slider_steps = int((max_val - min_val) / 0.01)
    
            # Configure left border slider
            self.ui.leftBorderSlider_2.setMinimum(0)
            self.ui.leftBorderSlider_2.setMaximum(slider_steps)
            self.ui.leftBorderSlider_2.setSingleStep(1)  # Each step corresponds to 0.01 in the dataset
            self.ui.leftBorderSlider_2.setPageStep(10)
            self.ui.leftBorderSlider_2.setValue(int((self.borders_data[0] - min_val) / 0.01))
            #self.ui.leftBorderSlider_2.setTickPosition(QSlider.TicksBothSides)
            #self.ui.leftBorderSlider_2.setTickInterval(slider_steps // 10)
    
            # Configure right border slider
            self.ui.rightBorderSlider_2.setMinimum(0)
            self.ui.rightBorderSlider_2.setMaximum(slider_steps)
            self.ui.rightBorderSlider_2.setSingleStep(1)  # Each step corresponds to 0.01 in the dataset
            self.ui.rightBorderSlider_2.setPageStep(10)
            self.ui.rightBorderSlider_2.setValue(int((self.borders_data[1] - min_val) / 0.01))
            #self.ui.rightBorderSlider_2.setTickPosition(QSlider.TicksBothSides)
            #self.ui.rightBorderSlider_2.setTickInterval(slider_steps // 10)
    
            # Update labels
            self.ui.leftMinLabel_2.setText(f"{min_val * 1e-6:.3f} mm")
            self.ui.leftMaxLabel_2.setText(f"{max_val * 1e-6:.3f} mm")
            self.ui.rightMinLabel_2.setText(f"{min_val * 1e-6:.3f} mm")
            self.ui.rightMaxLabel_2.setText(f"{max_val * 1e-6:.3f} mm")
            self.ui.leftSliderValueLabel_2.setText(f"{self.borders_data[0] * 1e-6:.2f}")
            self.ui.rightSliderValueLabel_2.setText(f"{self.borders_data[1] * 1e-6:.2f}")
    
            # Set slider positions
            self.update_slider_label_position(self.ui.leftBorderSlider_2, self.ui.leftSliderValueLabel_2, int((self.borders_data[0] - min_val) / 0.01))
            self.update_slider_label_position(self.ui.rightBorderSlider_2, self.ui.rightSliderValueLabel_2, int((self.borders_data[1] - min_val) / 0.01))
    
    


    def flip_dataset(self):
        """Flip the dataset and update borders, sliders, and labels."""
        if self.X_data.size > 0:
            max_x = max(self.X_data)  # Maximum X value
            min_x = min(self.X_data)  # Minimum X value
    
            if self.data_is_flipped:
                # Flip the dataset
                self.X_data_range = max_x - (self.X_data - min_x)  # Reverse X axis
                left_border = max_x - (self.original_borders_data[0] - min_x)
                right_border = max_x - (self.original_borders_data[1] - min_x)
                # Update borders based on flipped state
                self.borders_data = [min(left_border, right_border), max(left_border, right_border)]
            else:
                # Restore dataset to original state (unflipped)
                self.X_data_range = self.X_data.copy()
                self.borders_data = self.original_borders_data.copy()
    
            # Update sliders and plot
            self.reset_data_window()  # Adjust sliders and their ranges
            self.redraw_data_preview()  # Update the plot
    

    def flip_data(self, state):
        """Handle flip checkbox state change and update plot."""
        self.data_is_flipped = state == Qt.Checked
        self.flip_dataset()
        self.ui.apply_parameters_calib_tab_Button.setEnabled(True)
        self.redraw_data_preview()
        self.main_window.alignment_tab.reset_calibration_state()

    

    def differentiate_for_peak_finding(self, test_data, filterwidth):
        """Differentiate data for peak finding, with optional smoothing."""
        if filterwidth != 0:
            test_data = savgol_filter(test_data, 1 + filterwidth * 2, 1)  # Smooth data
        # Pad test_data to maintain size after diff
        test_data = np.diff(test_data, 1, append=test_data[-1])  # Append last value to keep length
        non_zero = test_data[np.where(test_data != 0)]
        if non_zero.size == 0:
            print("Warning: All derivatives are zero, returning zeros")
            return np.zeros_like(test_data)
        test_data = test_data / np.min(np.abs(non_zero))  # Normalize to smallest non-zero
        test_data = np.abs(test_data)  # Flip to positive for peak detection
        return test_data
    
    def find_step_pos(self, X, Y, Mode, fixed_filterwidth=0, variable_set="Alignment"):
        """Find step positions in calibration data for plateau detection."""
        step_dist = self.G_step_distance
        step_num = self.G_number_of_steps
        x_interval = np.abs(X[-1] - X[0])
    
        if x_interval == 0:
            print("Error: X range is zero, cannot compute steps")
            return None
    
        # Calculate required point spacing for peaks
        step_distance_pxls = max(int(step_dist / x_interval * X.size), 1)
    
        # Smooth and differentiate the data for peak finding
        test_data = self.differentiate_for_peak_finding(Y, filterwidth=fixed_filterwidth)
        print("test_data max:", np.max(test_data))
    
        # Detect peaks in the differentiated data
        peaks, properties = find_peaks(test_data, distance=step_distance_pxls, height=np.percentile(test_data, 10))
        peak_pos_pxls = list(peaks)
        peak_height = list(properties["peak_heights"])
    
        # Enforce step count (required number of steps = step_num - 1)
        while len(peak_pos_pxls) > (step_num - 1):
            smallest_peak = peak_height.index(min(peak_height))
            del peak_height[smallest_peak]
            del peak_pos_pxls[smallest_peak]
    
        return X[peak_pos_pxls]
    

    def get_closest_pxl_to_value(arr,val):
        diff = np.abs(val-arr)
        min = np.min(diff)
        return np.where(diff==min)
    
    def apply_parameters_to_data(self, X, Y, borders, is_flipped):
        """Apply borders and optionally flip the dataset for downstream processing."""
        print(f"Applying parameters: borders={borders}, is_flipped={is_flipped}")
    
        # Select the flipped or unflipped dataset
        X_out, Y_out = X.copy(), Y.copy()
    
        # Ensure the flipped dataset is used
        if is_flipped:
            print(f"Using flipped data: X range {np.min(self.X_data_range):.3f} to {np.max(self.X_data_range):.3f}")
            X_out = self.X_data_range  # Use already flipped dataset
        else:
            X_out = X  # Use the original dataset
    
        # Apply borders to trim the dataset
        borders_adjusted = sorted(borders)  # Ensure valid borders
        print(f"Adjusted borders: {borders_adjusted}")
    
        indices = np.where((X_out >= borders_adjusted[0]) & (X_out <= borders_adjusted[1]))[0]
        if len(indices) == 0:
            print("Warning: No data within borders")
            return X_out, Y_out  # Return untrimmed dataset for visualization
    
        # Apply borders to trim the dataset
        X_out, Y_out = X_out[indices], Y_out[indices]
        print(f"Trimmed Data: X range {np.min(X_out):.3f} to {np.max(X_out):.3f}, "
              f"Y range {np.min(Y_out):.3f} to {np.max(Y_out):.3f}")
    
        return X_out, Y_out
    


    

    def estimate_plateaus(self, X, Y, ax, plot_plateau=True, variable_set="Alignment"):
        """Estimate plateau positions for red bars."""
        step_dist = self.G_step_distance
        step_pos = self.find_step_pos(X, Y, "automatic Mode", fixed_filterwidth=0, variable_set=variable_set)
        if step_pos is None:
            print("Error: Could not find all required steps!")
            return None, None
    
        # Recalculate plateau positions
        estimate_plateaus_pos = [(X[0] + step_pos[0]) / 2]
        for i in range(len(step_pos) - 1):
            estimate_plateaus_pos.append((step_pos[i] + step_pos[i + 1]) / 2)
        estimate_plateaus_pos.append((step_pos[-1] + X[-1]) / 2)
    
        # Draw bars for plateaus
        if plot_plateau:
            y_min, y_max = ax.get_ylim()
            bar_heights = y_max - y_min
            ax.bar(
                estimate_plateaus_pos,
                bar_heights,
                bottom=y_min,
                alpha=0.25,
                width=step_dist,
                color="r",
                edgecolor="k"
            )
            #print(f"Plateau positions: {estimate_plateaus_pos}")
            print(f" step_pos={step_pos}")
        return estimate_plateaus_pos, step_pos


    
    def apply_parameters(self):
        """Apply parameters only if step distance is valid, else show error."""
        text = self.ui.Min_Step_LineEdit.text().strip()
        if not text:
            QMessageBox.critical(self.main_window, "Error", "Missing step distance input. Please enter a valid number.")
            print("Apply failed: Missing step distance")
            return
        try:
            step_distance = float(text)
            if step_distance <= 0:
                QMessageBox.critical(self.main_window, "Error", "Step distance must be positive. Please enter a valid number.")
                print(f"Apply failed: Negative step distance: {step_distance}")
                return
        except (ValueError, TypeError):
            QMessageBox.critical(self.main_window, "Error", "Invalid step distance input. Please enter a valid number.")
            print(f"Apply failed: Invalid step distance: {text}")
            return
        self.update_number_of_steps(self.ui.Nb_steps_spinBox.value())
        self.update_step_distance(self.ui.Min_Step_LineEdit.text())
        self.redraw_data_preview()
        QMessageBox.information(self.main_window, "Success", "Parameters applied!")
        #self.ui.apply_parameters_calib_tab_Button.setEnabled(False)
        self.main_window.alignment_tab.reset_calibration_state()

    def draw_ylabel(self, ax, quantity="Calibration"):
        """Set y-label for the plot based on calibration settings."""
        if quantity == "Calibration":
            if self.G_cal_setting == 1:
                # Use p-type or n-type based on G_carrier_type
                carrier_label = "p-type" if self.G_carrier_type == "B" else "n-type"
                identifier = f"{carrier_label} charge carrier concentration"
                unit = "cm$^{-3}$"
            elif self.G_cal_setting == 2:
                identifier = "SRP measured resistivity "
                unit = "cm"
            elif self.G_cal_setting == 3:
                ax.set_ylabel(self.denomination)
                return
            if not self.scale_cal_data:  # Log scale if scale_cal_data is False
                label = f"{identifier} [$log_{{10}}$({unit})]"
            else:
                label = f"{identifier} [{unit}]"
        else:  # Not implemented for measurement data in this context
            label = "Unspecified"
        ax.set_ylabel(label, fontsize=10)
    
    def redraw_data_preview(self):
        """Redraw the data preview plot with borders, flip state, grid, and red bars."""
        self.figure.clear()
        print("Canvas size:", self.canvas.size().width(), self.canvas.size().height())
        ax = self.figure.add_subplot(111)
    
        # Ensure trimming and flipping are respected
        if self.X_data.size > 1:
            # Apply trimming via borders and optionally flip the dataset
            X_trimmed, Y_trimmed = self.apply_parameters_to_data(
                self.X_data, self.Y_data, self.borders_data, self.data_is_flipped
            )
            
            # Plot the trimmed/processed data
            ax.plot(X_trimmed * 1e-6 , Y_trimmed, label="Calibration", color="green")
            ax.legend()
    
            # Detect and plot plateaus using the trimmed/processed data
            self.estimate_plateaus(
                X_trimmed * 1e-6, Y_trimmed, ax, plot_plateau=True, variable_set="Alignment"
            )
    
            # Update axis limits dynamically
            y_min = np.nanmin(Y_trimmed)
            y_max = np.nanmax(Y_trimmed)
            y_range = y_max - y_min
            y_mid = (y_max + y_min) / 2
            ax.set_ylim(y_mid - (y_range / 2) * 1.03, y_mid + (y_range / 2) * 1.03)
            ax.set_xlim(self.borders_data[0] * 1e-6, self.borders_data[1] * 1e-6)
            print("X-axis limits:", ax.get_xlim())
    
            # Label the axes
            ax.set_xlabel("Depth [mm]")
            #ax.set_ylabel(
            #    f"{self.G_carrier_type} Density [$log_{{10}}$(cm$^{{-3}}$)]"
            #    if self.G_cal_setting == 1 else "Resistivity [$cm$]"
            #)
            self.draw_ylabel(ax, quantity="Calibration")
            ax.grid(True)
    
        # Draw the updated canvas
        self.canvas.draw_idle()
    